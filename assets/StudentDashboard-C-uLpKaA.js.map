{"version":3,"file":"StudentDashboard-C-uLpKaA.js","sources":["../../src/pages/student/StudentDashboard.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Clock, CheckCircle } from 'lucide-react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useTranslation } from '../../contexts/LanguageContext';\r\nimport { useEffect, useState } from 'react';\r\nimport type { StudentAttendanceResponse } from '../../types';\r\nimport { useStudentClasses, useStudentAttendances } from '../../hooks/useClasses';\r\nimport { extractString, extractDate } from '../../utils/sqlNull';\r\nimport CheckInModal from '../../components/modals/CheckInModal';\r\n\r\ntype Day = 'Monday' | 'Tuesday' | 'Wednesday' | 'Thursday' | 'Friday';\r\n\r\ntype WeekDay = 'Sunday' | 'Monday' | 'Tuesday' | 'Wednesday' | 'Thursday' | 'Friday' | 'Saturday';\r\n\r\ninterface ScheduleItem {\r\n  id: string;\r\n  day: Day;\r\n  startTime: string;\r\n  endTime: string;\r\n  courseCode: string;\r\n  courseName: string;\r\n  className: string;\r\n  credits: number;\r\n  room: string;\r\n  topic: string;\r\n  weekNumber: number;\r\n  classId: number;\r\n  actualDate?: Date;\r\n  meetingId: number;\r\n}\r\n\r\n// Helper to extract day name from date string\r\nconst getDayFromDate = (dateValue: unknown): Day | null => {\r\n  const date = extractDate(dateValue as any);\r\n  if (!date) return null;\r\n  const dayIndex = date.getDay();\r\n  const daysMap: Record<number, Day> = {\r\n    1: 'Monday',\r\n    2: 'Tuesday',\r\n    3: 'Wednesday',\r\n    4: 'Thursday',\r\n    5: 'Friday',\r\n  };\r\n  return daysMap[dayIndex] || null;\r\n};\r\n\r\n// Helper to extract time (HH:mm) from jam_pertemuan which can be time-only or ISO datetime\r\nconst getTimeFromDate = (dateValue: unknown): string => {\r\n  const dateStr = extractString(dateValue as any);\r\n  if (!dateStr) return '00:00';\r\n\r\n  const timeOnlyMatch = dateStr.match(/^(\\d{1,2}):(\\d{2})(?::\\d{2})?$/);\r\n  if (timeOnlyMatch) {\r\n    const hh = timeOnlyMatch[1].padStart(2,'0');\r\n    const mm = timeOnlyMatch[2];\r\n    return `${hh}:${mm}`;\r\n  }\r\n\r\n  const afterT = dateStr.split('T')[1];\r\n  if (afterT) {\r\n    const part = afterT.split('.')[0].split('Z')[0];\r\n    const [hh = '00', mm = '00'] = part.split(':');\r\n    return `${hh.padStart(2,'0')}:${mm.padStart(2,'0')}`;\r\n  }\r\n\r\n  try {\r\n    const d = new Date(dateStr);\r\n    if (!isNaN(d.getTime())) {\r\n      return d.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });\r\n    }\r\n  } catch {}\r\n\r\n  return '00:00';\r\n};\r\n\r\n// Helper to get current week's start (Sunday) and end (Saturday)\r\nconst getCurrentWeekRange = (): { start: Date; end: Date } => {\r\n  const today = new Date();\r\n  const dayOfWeek = today.getDay();\r\n  \r\n  const daysToSunday = dayOfWeek === 0 ? 0 : dayOfWeek;\r\n  \r\n  const start = new Date(today);\r\n  start.setDate(today.getDate() - daysToSunday);\r\n  start.setHours(0, 0, 0, 0);\r\n  \r\n  const end = new Date(start);\r\n  end.setDate(start.getDate() + 6);\r\n  end.setHours(23, 59, 59, 999);\r\n  \r\n  return { start, end };\r\n};\r\n\r\nconst StudentDashboard: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const { t } = useTranslation();\r\n  const [thisWeekItems, setThisWeekItems] = useState<(ScheduleItem & { weekDay: WeekDay })[]>([]);\r\n  const [showCheckInModal, setShowCheckInModal] = useState(false);\r\n  const [checkInMeetingId, setCheckInMeetingId] = useState<number | null>(null);\r\n  const [checkInCourseName, setCheckInCourseName] = useState('');\r\n  const [editProof, setEditProof] = useState('');\r\n  const [editDescription, setEditDescription] = useState('');\r\n  const [editModalOpen, setEditModalOpen] = useState(false);\r\n  const [editingAttendance, setEditingAttendance] = useState<StudentAttendanceResponse | null>(null);\r\n\r\n  // Get this week's date range for backend filtering\r\n  const { start, end } = React.useMemo(() => getCurrentWeekRange(), []);\r\n  const startDay = start.toISOString().split('T')[0];\r\n  const endDate = end.toISOString().split('T')[0];\r\n\r\n  // Fetch classes with this week's date range\r\n  const { data: classes = [] } = useStudentClasses(\r\n    user?.studentId || '',\r\n    { start_day: startDay, end_day: endDate }\r\n  );\r\n\r\n  // Fetch attendances\r\n  const { data: attendances = [] } = useStudentAttendances();\r\n\r\n  const openCheckInModal = (meetingId: number, courseName: string) => {\r\n    setCheckInMeetingId(meetingId);\r\n    setCheckInCourseName(courseName);\r\n    setShowCheckInModal(true);\r\n  };\r\n\r\n  const closeCheckInModal = () => {\r\n    setShowCheckInModal(false);\r\n    setCheckInMeetingId(null);\r\n    setCheckInCourseName('');\r\n  };\r\n\r\n  const startEditProof = (attendance: StudentAttendanceResponse) => {\r\n    setEditingAttendance(attendance);\r\n    setEditProof(attendance.link_bukti || '');\r\n    setEditDescription(attendance.deskripsi || '');\r\n    setEditModalOpen(true);\r\n  };\r\n\r\n  const cancelEditProof = () => {\r\n    setEditingAttendance(null);\r\n    setEditProof('');\r\n    setEditDescription('');\r\n    setEditModalOpen(false);\r\n  };\r\n\r\n  const isCheckedIn = (meetingId: number): boolean => {\r\n    return Array.isArray(attendances) && attendances.some(att => att.id_pertemuan === meetingId);\r\n  };\r\n\r\n  const getAttendanceInfo = (meetingId: number): StudentAttendanceResponse | undefined => {\r\n    return Array.isArray(attendances) ? attendances.find(att => att.id_pertemuan === meetingId) : undefined;\r\n  };\r\n\r\n  const canCheckIn = (item: ScheduleItem, absensiAktif: boolean): { allowed: boolean; reason?: string } => {\r\n    if (!item.actualDate) {\r\n      return { allowed: false, reason: 'Invalid meeting date' };\r\n    }\r\n\r\n    if (isCheckedIn(item.meetingId)) {\r\n      return { allowed: false, reason: 'Already checked in' };\r\n    }\r\n\r\n    if (!absensiAktif) {\r\n      return { \r\n        allowed: false,\r\n        reason: 'Attendance not yet active'\r\n      };\r\n    }\r\n\r\n    return { allowed: true };\r\n  };\r\n\r\n  const getAttendanceColors = (status: string): { border: string; bg: string; text: string; icon: string } => {\r\n    const normalizedStatus = status.toLowerCase();\r\n    if (normalizedStatus === 'hadir') {\r\n      return { \r\n        border: 'border-green-300', \r\n        bg: 'bg-green-50', \r\n        text: 'text-green-700', \r\n        icon: 'text-green-600' \r\n      };\r\n    } else if (normalizedStatus === 'izin' || normalizedStatus === 'sakit') {\r\n      return { \r\n        border: 'border-yellow-300', \r\n        bg: 'bg-yellow-50', \r\n        text: 'text-yellow-700', \r\n        icon: 'text-yellow-600' \r\n      };\r\n    } else if (normalizedStatus === 'alfa') {\r\n      return { \r\n        border: 'border-red-300', \r\n        bg: 'bg-red-50', \r\n        text: 'text-red-700', \r\n        icon: 'text-red-600' \r\n      };\r\n    } else if (normalizedStatus === 'terlambat') {\r\n      return { \r\n        border: 'border-orange-300', \r\n        bg: 'bg-orange-50', \r\n        text: 'text-orange-700', \r\n        icon: 'text-orange-600' \r\n      };\r\n    }\r\n    return { \r\n      border: 'border-green-300', \r\n      bg: 'bg-green-50', \r\n      text: 'text-green-700', \r\n      icon: 'text-green-600' \r\n    };\r\n  };\r\n\r\n  const formatDateTime = (dateString: string | null | undefined): { date: string; time: string } | null => {\r\n    if (!dateString) return null;\r\n    try {\r\n      const date = new Date(dateString);\r\n      if (isNaN(date.getTime())) return null;\r\n      \r\n      return {\r\n        date: date.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' }),\r\n        time: date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false })\r\n      };\r\n    } catch {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const items: ScheduleItem[] = [];\r\n    classes.forEach(classData => {\r\n      (classData.meeting_schedules ?? []).forEach(meeting => {\r\n        const day = getDayFromDate(meeting.tgl_pertemuan);\r\n        \r\n        if (!day) return;\r\n        \r\n        const startTime = getTimeFromDate(meeting.jam_pertemuan);\r\n        const actualDate = extractDate(meeting.tgl_pertemuan);\r\n        \r\n        // Skip if no valid date\r\n        if (!actualDate) return;\r\n        \r\n        const totalSKS = classData.sks_tatap_muka + classData.sks_praktek + classData.sks_prak_lapangan + classData.sks_simulasi;\r\n        const durationMinutes = totalSKS * 60;\r\n        \r\n        const [startHours, startMinutes] = startTime.split(':').map(Number);\r\n        const totalMinutes = startHours * 60 + startMinutes + durationMinutes;\r\n        const endHours = Math.floor(totalMinutes / 60) % 24;\r\n        const endMinutes = totalMinutes % 60;\r\n        const endTime = `${String(endHours).padStart(2, '0')}:${String(endMinutes).padStart(2, '0')}`;\r\n\r\n        items.push({\r\n          id: `${classData.kelas_id}-${meeting.id}`,\r\n          day,\r\n          startTime,\r\n          endTime,\r\n          courseCode: classData.kode_mk,\r\n          courseName: classData.nama_mk,\r\n          className: classData.nama_kelas,\r\n          credits: totalSKS,\r\n          room: extractString(meeting.media_pembelajaran, 'TBA'),\r\n          topic: extractString(meeting.topik, ''),\r\n          weekNumber: meeting.pertemuan_ke,\r\n          classId: classData.kelas_id,\r\n          actualDate,\r\n          meetingId: meeting.id,\r\n        });\r\n      });\r\n    });\r\n\r\n    // Backend already filtered by this week's date range, just add weekDay labels\r\n    const weekItems: (ScheduleItem & { weekDay: WeekDay })[] = items\r\n      .filter(item => item.actualDate) // Ensure valid date\r\n      .map(item => {\r\n        const weekDayIndex = item.actualDate!.getDay();\r\n        const weekDaysMap: Record<number, WeekDay> = {\r\n          0: 'Sunday',\r\n          1: 'Monday',\r\n          2: 'Tuesday',\r\n          3: 'Wednesday',\r\n          4: 'Thursday',\r\n          5: 'Friday',\r\n          6: 'Saturday',\r\n        };\r\n        return {\r\n          ...item,\r\n          weekDay: weekDaysMap[weekDayIndex] || 'Monday',\r\n        };\r\n      })\r\n      .sort((a, b) => {\r\n        if (!a.actualDate || !b.actualDate) return 0;\r\n        return a.actualDate.getTime() - b.actualDate.getTime();\r\n      });\r\n    \r\n    setThisWeekItems(weekItems);\r\n  }, [classes]);\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">{t('dashboard.welcomeBack')}</h1>\r\n      </div>\r\n\r\n      {/* Quick Stats */}\r\n      {/* <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <div className=\"card\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-2 bg-primary-100 rounded-lg\">\r\n              <BookOpen className=\"h-6 w-6 text-primary-600\" />\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <div className=\"text-sm font-medium text-gray-500\">Total Credits</div>\r\n              <div className=\"text-2xl font-bold text-gray-900\">xxx</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-2 bg-green-100 rounded-lg\">\r\n              <TrendingUp className=\"h-6 w-6 text-green-600\" />\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <div className=\"text-sm font-medium text-gray-500\">Current GPA</div>\r\n              <div className=\"text-2xl font-bold text-gray-900\">xxx</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n              <GraduationCap className=\"h-6 w-6 text-blue-600\" />\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <div className=\"text-sm font-medium text-gray-500\">Semester</div>\r\n              <div className=\"text-2xl font-bold text-gray-900\">xxx</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-2 bg-yellow-100 rounded-lg\">\r\n              <Calendar className=\"h-6 w-6 text-yellow-600\" />\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <div className=\"text-sm font-medium text-gray-500\">Classes Today</div>\r\n              <div className=\"text-2xl font-bold text-gray-900\">xxx</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div> */}\r\n\r\n      {/* This Week's Schedule */}\r\n      {thisWeekItems.length > 0 && (\r\n        <div className=\"card\">\r\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('studentDashboard.thisWeekSchedule')}</h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {thisWeekItems.map(item => {\r\n              // Find the class and meeting to get absensi_aktif\r\n              const classData = classes.find(c => c.kelas_id === item.classId);\r\n              const meeting = classData?.meeting_schedules?.find(m => m.id === item.meetingId);\r\n              const absensiAktif = meeting?.absensi_aktif === true || (typeof meeting?.absensi_aktif === 'object' && meeting.absensi_aktif?.Valid && meeting.absensi_aktif?.Bool);\r\n              \r\n              const checkedIn = isCheckedIn(item.meetingId);\r\n              const checkInStatus = canCheckIn(item, absensiAktif);\r\n              const attendanceInfo = getAttendanceInfo(item.meetingId);\r\n              const colors = attendanceInfo ? getAttendanceColors(attendanceInfo.status_kehadiran) : null;\r\n              \r\n              return (\r\n                <div \r\n                  key={item.id} \r\n                  onClick={() => checkInStatus.allowed && openCheckInModal(item.meetingId, item.courseName)}\r\n                  className={`p-3 border rounded-lg transition-colors flex flex-col ${\r\n                    checkedIn && colors\r\n                      ? `${colors.border} ${colors.bg} cursor-default` \r\n                      : checkInStatus.allowed\r\n                      ? 'border-gray-200 hover:bg-blue-50 hover:border-blue-300 cursor-pointer'\r\n                      : 'border-gray-300 bg-gray-100 cursor-not-allowed'\r\n                  }`}\r\n                  title={!checkInStatus.allowed ? checkInStatus.reason : undefined}\r\n                >\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-start justify-between gap-2 mb-2\">\r\n                      <div className=\"flex items-center gap-2 flex-wrap\">\r\n                        <span className=\"inline-block px-2.5 py-0.5 bg-primary-100 text-primary-700 text-xs font-semibold rounded\">\r\n                          {item.weekDay}\r\n                        </span>\r\n                        {item.actualDate && (\r\n                          <span className=\"text-xs text-gray-500 px-2 py-0.5 bg-gray-100 rounded\">\r\n                            {item.actualDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' })}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex flex-col items-end gap-0.5\">\r\n                        {checkedIn && attendanceInfo && colors && (\r\n                          <div className={`flex items-center gap-1 text-xs ${colors.text} font-medium`}>\r\n                            <CheckCircle className={`h-3 w-3 ${colors.icon}`} />\r\n                            <span>{t('studentDashboard.checkedIn')}</span>\r\n                          </div>\r\n                        )}\r\n                        <span className=\"text-xs text-gray-500\">Week {item.weekNumber}</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-xs font-semibold text-primary-600 mb-1\">{item.courseCode}</div>\r\n                    <h3 className=\"text-xs font-medium text-gray-900 line-clamp-2 mb-1\">{item.courseName}</h3>\r\n                    {item.topic && (\r\n                      <div className=\"text-xs text-gray-600 mb-2 italic line-clamp-2\">\r\n                        {item.topic}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex flex-col gap-1 text-xs text-gray-600 border-t border-gray-100 pt-2 mt-2\">\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                      <Clock className=\"h-3 w-3 flex-shrink-0\" />\r\n                      <span>{item.startTime} - {item.endTime}</span>\r\n                    </div>\r\n                  </div>\r\n                  {checkedIn && attendanceInfo && colors && (\r\n                    <div className={`mt-2 pt-2 border-t ${colors.border}`}>\r\n                      <div className=\"text-xs text-gray-600 space-y-0.5\">\r\n                        {(() => {\r\n                          const checkInTime = formatDateTime(attendanceInfo.waktu_masuk);\r\n                          const checkOutTime = attendanceInfo.waktu_keluar ? formatDateTime(attendanceInfo.waktu_keluar) : null;\r\n                          \r\n                          return (\r\n                            <>\r\n                              {checkInTime && (\r\n                                <div className=\"flex items-center justify-between\">\r\n                                  <span>{t('studentDashboard.checkIn')}:</span>\r\n                                  <span className=\"font-medium\">\r\n                                    {checkInTime.date} {checkInTime.time}\r\n                                  </span>\r\n                                </div>\r\n                              )}\r\n                              {checkOutTime && (\r\n                                <div className=\"flex items-center justify-between\">\r\n                                  <span>{t('studentDashboard.checkOut')}:</span>\r\n                                  <span className=\"font-medium\">\r\n                                    {checkOutTime.time}\r\n                                  </span>\r\n                                </div>\r\n                              )}\r\n                              <div className=\"flex items-center justify-between\">\r\n                                <span>{t('studentDashboard.status')}:</span>\r\n                                <span className={`font-medium ${colors.text}`}>{attendanceInfo.status_kehadiran}</span>\r\n                              </div>\r\n                              <button\r\n                                onClick={() => startEditProof(attendanceInfo)}\r\n                                className=\"mt-2 w-full text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700\"\r\n                                type=\"button\"\r\n                              >\r\n                                {t('studentDashboard.updateProof')}\r\n                              </button>\r\n                            </>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {!checkedIn && !checkInStatus.allowed && (\r\n                    <div className=\"mt-2 text-xs text-gray-600 text-center italic\">\r\n                      {checkInStatus.reason}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <CheckInModal\r\n        isOpen={showCheckInModal}\r\n        meetingId={checkInMeetingId}\r\n        courseName={checkInCourseName}\r\n        onClose={closeCheckInModal}\r\n      />\r\n      <CheckInModal\r\n        isOpen={editModalOpen}\r\n        meetingId={editingAttendance?.id_pertemuan || null}\r\n        courseName={editingAttendance?.nama_mk || ''}\r\n        onClose={cancelEditProof}\r\n        editMode={true}\r\n        existingProof={editProof}\r\n        existingDescription={editDescription}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StudentDashboard;\r\n"],"names":["getDayFromDate","dateValue","date","extractDate","dayIndex","getTimeFromDate","dateStr","extractString","timeOnlyMatch","hh","mm","afterT","part","d","getCurrentWeekRange","today","dayOfWeek","daysToSunday","start","end","StudentDashboard","user","useAuth","t","useTranslation","thisWeekItems","setThisWeekItems","useState","showCheckInModal","setShowCheckInModal","checkInMeetingId","setCheckInMeetingId","checkInCourseName","setCheckInCourseName","editProof","setEditProof","editDescription","setEditDescription","editModalOpen","setEditModalOpen","editingAttendance","setEditingAttendance","React","startDay","endDate","classes","useStudentClasses","attendances","useStudentAttendances","openCheckInModal","meetingId","courseName","closeCheckInModal","startEditProof","attendance","cancelEditProof","isCheckedIn","att","getAttendanceInfo","canCheckIn","item","absensiAktif","getAttendanceColors","status","normalizedStatus","formatDateTime","dateString","useEffect","items","classData","meeting","day","startTime","actualDate","totalSKS","durationMinutes","startHours","startMinutes","totalMinutes","endHours","endMinutes","endTime","weekItems","weekDayIndex","a","b","jsxs","jsx","c","m","checkedIn","checkInStatus","attendanceInfo","colors","CheckCircle","Clock","checkInTime","checkOutTime","Fragment","CheckInModal"],"mappings":"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"}