import{j as e}from"./query-vendor-B--u1oZD.js";import{r as a}from"./react-vendor-XXJdR_Id.js";import{u as D}from"./index-1e-qg3UH.js";import{v as R,P as E,F as h,i as T,aa as $,z as I,x as B,g as M}from"./ui-vendor-C-UqR_Df.js";const O=()=>{const{user:c,submitRoleRequest:w,getRoleRequests:m}=D(),[o,i]=a.useState("request"),[u,p]=a.useState([]),[n,S]=a.useState(""),[d,q]=a.useState("all"),[t,x]=a.useState({requestedRole:"student",reason:""}),[l,g]=a.useState({}),[b,y]=a.useState(!1),[C,f]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const r=await m();p(r)}catch(r){console.error("Failed to load role requests:",r)}})()},[m]);const j=[{value:"student_applicant",label:"Student Applicant",description:"Apply for admission to academic programs"},{value:"student",label:"Student",description:"Access for enrolled students"},{value:"lecturer",label:"Lecturer",description:"Faculty members and teaching staff"},{value:"staff",label:"Staff",description:"Administrative and support staff"},{value:"alumni",label:"Alumni",description:"Graduates and former students"},{value:"admin",label:"Administrator",description:"System administration access"}],A=()=>{const s={};return t.requestedRole||(s.requestedRole="Please select a role"),t.reason.trim()?t.reason.trim().length<20&&(s.reason="Please provide a more detailed reason (at least 20 characters)"):s.reason="Please provide a reason for your role request",g(s),Object.keys(s).length===0},k=async s=>{if(s.preventDefault(),!!A()){y(!0),f(!1);try{await w({userId:c?.id||"",requestedRole:t.requestedRole,currentRole:c?.role||"guest",reason:t.reason}),x({requestedRole:"student",reason:""}),g({}),f(!0);const r=await m();p(r),i("status")}catch(r){console.error("Failed to submit role request:",r)}finally{y(!1)}}},F=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=s=>{switch(s){case"pending":return e.jsx(M,{className:"h-4 w-4"});case"approved":return e.jsx(R,{className:"h-4 w-4"});case"rejected":return e.jsx(B,{className:"h-4 w-4"});default:return e.jsx(h,{className:"h-4 w-4"})}},v=s=>({guest:"Guest",staff:"Staff",student_applicant:"Student Applicant",student:"Student",lecturer:"Lecturer",alumni:"Alumni",admin:"Administrator"})[s]||s,N=u.filter(s=>{const r=s.id.toLowerCase().includes(n.toLowerCase())||s.reason.toLowerCase().includes(n.toLowerCase()),L=d==="all"||s.status===d;return r&&L});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Role Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Request new roles or check the status of your requests"})]})}),C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Role request submitted successfully!"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>i("request"),className:`py-2 px-1 border-b-2 font-medium text-sm ${o==="request"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(E,{className:"h-4 w-4 inline mr-2"}),"Request Role"]}),e.jsxs("button",{onClick:()=>i("status"),className:`py-2 px-1 border-b-2 font-medium text-sm ${o==="status"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(h,{className:"h-4 w-4 inline mr-2"}),"Request Status",u.filter(s=>s.status==="pending").length>0&&e.jsx("span",{className:"ml-2 bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full",children:u.filter(s=>s.status==="pending").length})]})]})}),o==="request"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Request New Role"}),e.jsx("p",{className:"text-gray-600",children:"Choose the role you would like to request and provide a detailed reason for your request."})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Current Role:"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:v(c?.role||"guest")})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"requestedRole",className:"block text-sm font-medium text-gray-700 mb-2",children:"Requested Role"}),e.jsx("select",{id:"requestedRole",value:t.requestedRole,onChange:s=>x({...t,requestedRole:s.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${l.requestedRole?"border-red-300":"border-gray-300"}`,children:j.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),l.requestedRole&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.requestedRole}),t.requestedRole&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:j.find(s=>s.value===t.requestedRole)?.description})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Request"}),e.jsx("textarea",{id:"reason",rows:4,value:t.reason,onChange:s=>x({...t,reason:s.target.value}),placeholder:"Please provide a detailed explanation for why you need this role...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${l.reason?"border-red-300":"border-gray-300"}`}),l.reason&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.reason}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Minimum 20 characters. Current: ",t.reason.length]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:b,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:b?"Submitting...":"Submit Request"})]})})]})]}),o==="status"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by request ID or reason...",value:n,onChange:s=>S(s.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),e.jsx("div",{children:e.jsxs("select",{value:d,onChange:s=>q(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})})]})}),e.jsx("div",{className:"space-y-4",children:N.length>0?N.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Request #",s.id]}),e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${F(s.status)}`,children:[P(s.status),e.jsx("span",{className:"ml-1 capitalize",children:s.status})]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Requested Role:"})," ",v(s.requestedRole)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Submitted:"})," ",s.submittedAt]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Reason:"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.reason})]}),s.comments&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Comments:"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.comments})]}),s.reviewedAt&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Reviewed:"})," ",s.reviewedAt,s.reviewedBy&&e.jsxs("span",{children:[" by ",s.reviewedBy]})]})]})]},s.id)):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(h,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No role requests found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n||d!=="all"?"No requests match your search criteria.":"You haven't submitted any role requests yet."}),!n&&d==="all"&&e.jsx("button",{onClick:()=>i("request"),className:"btn-primary",children:"Submit Your First Request"})]})})]})]})};export{O as default};
//# sourceMappingURL=RoleManagement-fWkcQ7Zz.js.map
