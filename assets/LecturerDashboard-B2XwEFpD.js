import{j as t}from"./query-vendor-B--u1oZD.js";import{r as u,g as C}from"./react-vendor-XXJdR_Id.js";import{u as L,e as k,c as m}from"./index-BFadXLuC.js";import{c as W}from"./useClasses-h-HHWjgv.js";import{A as $}from"./AttendanceModal-p7s7SbNG.js";import{g as A}from"./ui-vendor-Bvty7Z9l.js";import"./useAttendances-BRO_9oj9.js";import"./useLecturerAssignments-DTgRc4eP.js";const E=n=>{const r=k(n);if(!r)return null;const o=r.getDay();return{1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday"}[o]||null},H=n=>{const r=m(n);if(!r)return"00:00";const o=r.split("T")[1]?.split(".")[0]||r.split("T")[1]?.split("Z")[0];return o?o.substring(0,5):new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},F=()=>{const n=new Date,r=n.getDay(),o=r===0?0:r,c=new Date(n);c.setDate(n.getDate()-o),c.setHours(0,0,0,0);const d=new Date(c);return d.setDate(c.getDate()+6),d.setHours(23,59,59,999),{start:c,end:d}},q=()=>{const{user:n,currentSemester:r}=L(),[o,c]=u.useState([]),[d,x]=u.useState(null),{start:D,end:N}=C.useMemo(()=>F(),[]),b=D.toISOString().split("T")[0],j=N.toISOString().split("T")[0],{data:p,isLoading:S}=W(n?.employeeId||"",{semester:r,start_day:b,end_day:j});return u.useEffect(()=>{const e=[];(p??[]).forEach(s=>{s.meeting_schedules.forEach(a=>{const l=E(a.tgl_pertemuan);if(!l)return;const y=H(a.jam_pertemuan),g=k(a.tgl_pertemuan);if(!g)return;const h=s.sks_tatap_muka+s.sks_praktek+s.sks_prak_lapangan+s.sks_simulasi,T=h*60,[w,_]=y.split(":").map(Number),f=w*60+_+T,v=Math.floor(f/60)%24,I=f%60,M=`${String(v).padStart(2,"0")}:${String(I).padStart(2,"0")}`;e.push({id:`${s.kelas_id}-${a.id}`,day:l,startTime:y,endTime:M,courseCode:s.kode_mk,courseName:s.nama_mk,className:s.nama_kelas,credits:h,room:m(a.media_pembelajaran,"TBA"),topic:m(a.topik,""),weekNumber:a.pertemuan_ke,classId:s.kelas_id,actualDate:g,meetingId:a.id})})});const i=e.filter(s=>s.actualDate).map(s=>{const a=s.actualDate.getDay();return{...s,weekDay:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}[a]||"Monday"}}).sort((s,a)=>!s.actualDate||!a.actualDate?0:s.actualDate.getTime()-a.actualDate.getTime());c(i)},[p]),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lecturer Dashboard"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Academic Year 2024/2025"})]}),t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"This Week's Schedule"}),S?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading this week's schedule..."}):o.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No classes scheduled for this week"}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>{const i=e.actualDate?new Date(e.actualDate):null;if(i&&e.startTime){const[s,a]=e.startTime.split(":").map(Number);i.setHours(s,a,0,0)}return t.jsxs("button",{type:"button",onClick:()=>x({meetingId:e.meetingId,classId:e.classId,title:`${e.courseCode} â€¢ ${e.courseName}`,subtitle:`Week ${e.weekNumber}`,dateLabel:e.actualDate?.toLocaleDateString("id-ID",{weekday:"short",day:"numeric",month:"short"}),meetingDateTime:i||void 0,topic:e.topic||void 0}),className:"text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors flex flex-col cursor-pointer",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"inline-block px-2.5 py-0.5 bg-primary-100 text-primary-700 text-xs font-semibold rounded",children:e.weekDay}),e.actualDate&&t.jsx("span",{className:"text-xs text-gray-500 px-2 py-0.5 bg-gray-100 rounded",children:e.actualDate.toLocaleDateString("id-ID",{day:"numeric",month:"short"})})]}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Week ",e.weekNumber]})]}),t.jsx("div",{className:"text-xs font-semibold text-primary-600 mb-1",children:e.courseCode}),t.jsx("h3",{className:"text-xs font-medium text-gray-900 line-clamp-2 mb-1",children:e.courseName})]}),t.jsx("div",{className:"flex flex-col gap-1 text-xs text-gray-600 border-t border-gray-100 pt-2 mt-2",children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(A,{className:"h-3 w-3 flex-shrink-0"}),t.jsxs("span",{children:[e.startTime," - ",e.endTime]})]})})]},e.id)})})]}),t.jsx($,{selectedMeeting:d,onClose:()=>x(null)})]})};export{q as default};
//# sourceMappingURL=LecturerDashboard-B2XwEFpD.js.map
