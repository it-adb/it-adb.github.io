{"version":3,"file":"LecturerDashboard-HJP5HIB6.js","sources":["../../src/pages/lecturer/LecturerDashboard.tsx"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Clock, CheckCircle, XCircle, User, Users, Loader } from 'lucide-react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useTranslation } from '../../contexts/LanguageContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { useLecturerClasses } from '../../hooks/useClasses';\r\nimport { extractString, extractDate } from '../../utils/sqlNull';\r\nimport { apiService } from '../../services/api';\r\nimport AttendanceModal from '../../components/modals/AttendanceModal';\r\nimport { Card } from '../../components/ui';\r\nimport { logger } from '../../utils/logger';\r\n\r\ntype Day = 'Monday' | 'Tuesday' | 'Wednesday' | 'Thursday' | 'Friday';\r\n\r\ntype WeekDay = 'Sunday' | 'Monday' | 'Tuesday' | 'Wednesday' | 'Thursday' | 'Friday' | 'Saturday';\r\n\r\ninterface ScheduleItem {\r\n  id: string;\r\n  day: Day;\r\n  startTime: string;\r\n  endTime: string;\r\n  courseCode: string;\r\n  courseName: string;\r\n  className: string;\r\n  credits: number;\r\n  room: string;\r\n  topic: string;\r\n  weekNumber: number;\r\n  classId: number;\r\n  actualDate?: Date;\r\n  meetingId: number;\r\n}\r\n\r\n// Helper to extract day name from date string\r\nconst getDayFromDate = (dateValue: unknown): Day | null => {\r\n  const date = extractDate(dateValue as any);\r\n  if (!date) return null;\r\n  const dayIndex = date.getDay();\r\n  const daysMap: Record<number, Day> = {\r\n    1: 'Monday',\r\n    2: 'Tuesday',\r\n    3: 'Wednesday',\r\n    4: 'Thursday',\r\n    5: 'Friday',\r\n  };\r\n  return daysMap[dayIndex] || null;\r\n};\r\n\r\n// Helper to extract time (HH:mm) from jam_pertemuan which may be time-only or ISO datetime\r\nconst getTimeFromDate = (dateValue: unknown): string => {\r\n  const dateStr = extractString(dateValue as any);\r\n  if (!dateStr) return '00:00';\r\n\r\n  const timeOnlyMatch = dateStr.match(/^(\\d{1,2}):(\\d{2})(?::\\d{2})?$/);\r\n  if (timeOnlyMatch) {\r\n    const hh = timeOnlyMatch[1].padStart(2,'0');\r\n    const mm = timeOnlyMatch[2];\r\n    return `${hh}:${mm}`;\r\n  }\r\n\r\n  const afterT = dateStr.split('T')[1];\r\n  if (afterT) {\r\n    const part = afterT.split('.')[0].split('Z')[0];\r\n    const [hh = '00', mm = '00'] = part.split(':');\r\n    return `${hh.padStart(2,'0')}:${mm.padStart(2,'0')}`;\r\n  }\r\n\r\n  try {\r\n    const d = new Date(dateStr);\r\n    if (!isNaN(d.getTime())) {\r\n      return d.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });\r\n    }\r\n  } catch {}\r\n\r\n  return '00:00';\r\n};\r\n\r\n// Helper to get current week's start (Sunday) and end (Saturday)\r\nconst getCurrentWeekRange = (): { start: Date; end: Date } => {\r\n  const today = new Date();\r\n  const dayOfWeek = today.getDay();\r\n  \r\n  const daysToSunday = dayOfWeek === 0 ? 0 : dayOfWeek;\r\n  \r\n  const start = new Date(today);\r\n  start.setDate(today.getDate() - daysToSunday);\r\n  start.setHours(0, 0, 0, 0);\r\n  \r\n  const end = new Date(start);\r\n  end.setDate(start.getDate() + 6);\r\n  end.setHours(23, 59, 59, 999);\r\n  \r\n  return { start, end };\r\n};\r\n\r\nconst LecturerDashboard: React.FC = () => {\r\n  const { user, currentSemester } = useAuth();\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const queryClient = useQueryClient();\r\n  const [thisWeekItems, setThisWeekItems] = useState<(ScheduleItem & { weekDay: WeekDay })[]>([]);\r\n  const [selectedMeeting, setSelectedMeeting] = useState<{\r\n    meetingId: number;\r\n    classId: number;\r\n    title: string;\r\n    subtitle: string;\r\n    dateLabel?: string;\r\n    meetingDateTime?: Date;\r\n    topic?: string;\r\n  } | null>(null);\r\n  const [togglingMeetingId, setTogglingMeetingId] = useState<number | null>(null);\r\n  const [optimisticToggles, setOptimisticToggles] = useState<Record<number, boolean>>({});\r\n\r\n  // Track component mount and query enablement\r\n  useEffect(() => {\r\n    // Component mounted\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const enabled = Boolean(user?.employeeId && currentSemester);\r\n    logger.debug('LecturerDashboard - meetingRecapQuery enabled state:', enabled);\r\n    // Query enabled state updated\r\n  }, [user?.employeeId, currentSemester]);\r\n\r\n  // Compute this week's range and fetch lecturer classes via React Query\r\n  const { start, end } = React.useMemo(() => getCurrentWeekRange(), []);\r\n  const startDay = start.toISOString().split('T')[0];\r\n  const endDay = end.toISOString().split('T')[0];\r\n\r\n  const { data: rawClasses, isLoading: loading } = useLecturerClasses(\r\n    user?.employeeId || '',\r\n    { semester: currentSemester, start_day: startDay, end_day: endDay }\r\n  );\r\n\r\n  // Use the new efficient meeting recap endpoint instead of N+1 queries\r\n  // Allow employeeId '0' as valid — only require employeeId to be non-null/undefined\r\n  const meetingRecapQueryEnabled = Boolean(user?.employeeId != null && currentSemester);\r\n\r\n  const { data: meetingRecapData, isLoading: meetingRecapLoading } = useQuery({\r\n    queryKey: ['lecturer-meeting-recap', user?.employeeId, currentSemester],\r\n    queryFn: async () => {\r\n      if (!user?.employeeId || !currentSemester) {\r\n        return null;\r\n      }\r\n\r\n      try {\r\n        const res = await apiService.getLecturerMeetingRecap(user.employeeId, { semester: currentSemester });\r\n        return res;\r\n      } catch (err) {\r\n        throw err;\r\n      }\r\n    },\r\n    enabled: meetingRecapQueryEnabled,\r\n  });\r\n\r\n  // Compute meeting recap data from the efficient endpoint\r\n  const meetingRecaps = useMemo(() => {\r\n    if (!meetingRecapData?.classes) return [];\r\n\r\n    return meetingRecapData.classes.map((classData: any) => {\r\n      // Normalize meetings with robust fallbacks and sort by pertemuan (weekNumber)\r\n      const meetings = (Array.isArray(classData.meetings) ? classData.meetings : []).map((meeting: any) => {\r\n        // Use `pertemuan_ke` as the authoritative meeting number\r\n        let computedWeekNumber = Number(meeting.pertemuan_ke ?? meeting.pertemuanKe ?? meeting.pertemuan ?? 0);\r\n        if (Number.isNaN(computedWeekNumber)) computedWeekNumber = 0;\r\n\r\n        // Normalize attendance counts (strings/numbers) and prefer recorded_attendances over total_attendances\r\n        const recordedRaw = meeting.recorded_attendances ?? meeting.recordedAttendances ?? meeting.total_attendances ?? meeting.total_attendances_count ?? 0;\r\n        const recorded = Number(recordedRaw) || 0;\r\n\r\n        // Normalize attendance_complete values (boolean or string/number variants)\r\n        const acRaw = meeting.attendance_complete ?? meeting.attendanceComplete;\r\n        const attendanceComplete = acRaw === true || acRaw === 'true' || acRaw === 1 || acRaw === '1';\r\n\r\n        // Determine student attendance complete: prefer explicit flag, otherwise infer from counts\r\n        const studentComplete = attendanceComplete || (classData.total_students ? recorded >= Number(classData.total_students) : recorded > 0);\r\n\r\n        // Determine lecturer assigned: check if id_dosen exists and is not null/empty\r\n        const lecturerAssigned = Boolean(meeting.id_dosen);\r\n\r\n        const computed = {\r\n          id: meeting.id,\r\n          weekNumber: computedWeekNumber,\r\n          date: meeting.tgl_pertemuan ? new Date(meeting.tgl_pertemuan) : null,\r\n          topic: meeting.topik ?? meeting.topic ?? undefined,\r\n          studentAttendanceComplete: Boolean(studentComplete),\r\n          lecturerAssigned,\r\n          totalStudents: Number(classData.total_students ?? 0),\r\n          recordedAttendances: recorded,\r\n          absensiAktif: Boolean(meeting.absensi_aktif ?? meeting.absensiAktif),\r\n        };\r\n\r\n        return computed;\r\n      }).sort((a: any, b: any) => {\r\n        // Primary sort by computed weekNumber, fallback to date\r\n        if ((a.weekNumber ?? 0) !== (b.weekNumber ?? 0)) return (a.weekNumber ?? 0) - (b.weekNumber ?? 0);\r\n        const aDate = a.date ? a.date.getTime() : 0;\r\n        const bDate = b.date ? b.date.getTime() : 0;\r\n        return aDate - bDate;\r\n      });\r\n\r\n      return {\r\n        classId: classData.class_id,\r\n        courseCode: classData.kode_mk,\r\n        courseName: classData.course_name,\r\n        className: classData.class_name,\r\n        sksTatapMuka: classData.sks_tatap_muka,\r\n        sksPraktek: classData.sks_praktek,\r\n        sksPrakLapangan: classData.sks_prak_lapangan,\r\n        sksSimulasi: classData.sks_simulasi,\r\n        meetings,\r\n      };\r\n    });\r\n  }, [meetingRecapData]);\r\n\r\n  // Debug logs to inspect the raw API response and the computed meeting recaps\r\n  useEffect(() => {\r\n    if (meetingRecapData) {\r\n      console.debug('LecturerDashboard - raw meetingRecapData:', meetingRecapData);\r\n    }\r\n    if (meetingRecaps && meetingRecaps.length) {\r\n      console.debug('LecturerDashboard - mapped meetingRecaps:', meetingRecaps);\r\n      meetingRecaps.forEach((c: any) => {\r\n        console.debug(`LecturerDashboard - class ${c.classId} meetings:`, c.meetings.map((m: any) => ({ id: m.id, weekNumber: m.weekNumber, date: m.date, absensiAktif: m.absensiAktif, recorded: m.recordedAttendances, lecturerAssigned: m.lecturerAssigned, id_dosen: (m as any).id_dosen })));\r\n      });\r\n    }\r\n  }, [meetingRecapData, meetingRecaps]);\r\n\r\n  useEffect(() => {\r\n    const items: ScheduleItem[] = [];\r\n    (Array.isArray(rawClasses) ? rawClasses : []).forEach(classData => {\r\n      if (!classData) {\r\n        return;\r\n      }\r\n      if (!Array.isArray(classData.meeting_schedules)) {\r\n        return;\r\n      }\r\n      classData.meeting_schedules.forEach(meeting => {\r\n        if (!meeting) {\r\n          return;\r\n        }\r\n        const day = getDayFromDate(meeting.tgl_pertemuan);\r\n        \r\n        if (!day) {\r\n          return;\r\n        }\r\n        \r\n        const startTime = getTimeFromDate(meeting.jam_pertemuan);\r\n        const actualDate = extractDate(meeting.tgl_pertemuan as any);\r\n        \r\n        // Skip if no valid date\r\n        if (!actualDate) {\r\n          return;\r\n        }\r\n        \r\n        const totalSKS = (classData.sks_tatap_muka || 0) + (classData.sks_praktek || 0) + (classData.sks_prak_lapangan || 0) + (classData.sks_simulasi || 0);\r\n        const durationMinutes = totalSKS * 60;\r\n        \r\n        const [startHours, startMinutes] = startTime.split(':').map(Number);\r\n        const totalMinutes = startHours * 60 + startMinutes + durationMinutes;\r\n        const endHours = Math.floor(totalMinutes / 60) % 24;\r\n        const endMinutes = totalMinutes % 60;\r\n        const endTime = `${String(endHours).padStart(2, '0')}:${String(endMinutes).padStart(2, '0')}`;\r\n\r\n        items.push({\r\n          id: `${classData.kelas_id}-${meeting.id}`,\r\n          day,\r\n          startTime,\r\n          endTime,\r\n          courseCode: classData.kode_mk,\r\n          courseName: classData.nama_mk,\r\n          className: classData.nama_kelas,\r\n          credits: totalSKS,\r\n          room: extractString(meeting.media_pembelajaran, 'TBA'),\r\n          topic: extractString(meeting.topik, ''),\r\n          weekNumber: meeting.pertemuan_ke,\r\n          classId: classData.kelas_id,\r\n          actualDate,\r\n          meetingId: meeting.id,\r\n        });\r\n      });\r\n    });\r\n\r\n    // Backend already filtered by this week's date range, just add weekDay labels\r\n    const weekItems: (ScheduleItem & { weekDay: WeekDay })[] = items\r\n      .filter(item => item.actualDate) // Ensure valid date\r\n      .map(item => {\r\n        const weekDayIndex = item.actualDate!.getDay();\r\n        const weekDaysMap: Record<number, WeekDay> = {\r\n          0: 'Sunday',\r\n          1: 'Monday',\r\n          2: 'Tuesday',\r\n          3: 'Wednesday',\r\n          4: 'Thursday',\r\n          5: 'Friday',\r\n          6: 'Saturday',\r\n        };\r\n        return {\r\n          ...item,\r\n          weekDay: weekDaysMap[weekDayIndex] || 'Monday',\r\n        };\r\n      })\r\n      .sort((a, b) => {\r\n        if (!a.actualDate || !b.actualDate) return 0;\r\n        return a.actualDate.getTime() - b.actualDate.getTime();\r\n      });\r\n    \r\n    setThisWeekItems(weekItems);\r\n  }, [rawClasses]);\r\n\r\n  const handleToggleAttendance = async (e: React.MouseEvent, meetingId: number, currentStatus: boolean) => {\r\n    e.stopPropagation();\r\n    setTogglingMeetingId(meetingId);\r\n    \r\n    // Optimistic update\r\n    setOptimisticToggles(prev => ({\r\n      ...prev,\r\n      [meetingId]: !currentStatus,\r\n    }));\r\n    \r\n    try {\r\n      await apiService.updateMeeting(meetingId, {\r\n        absensi_aktif: !currentStatus,\r\n      });\r\n      \r\n      // Invalidate both the meeting recap and class meetings queries to sync with AttendanceModal\r\n      await queryClient.invalidateQueries({\r\n        queryKey: ['lecturer-meeting-recap', user?.employeeId, currentSemester],\r\n      });\r\n      await queryClient.invalidateQueries({\r\n        queryKey: ['class-meetings'],\r\n      });\r\n      \r\n      // Clear optimistic toggle once data is confirmed\r\n      setOptimisticToggles(prev => {\r\n        const newToggles = { ...prev };\r\n        delete newToggles[meetingId];\r\n        return newToggles;\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to toggle attendance:', error);\r\n      // Revert optimistic update on error\r\n      setOptimisticToggles(prev => {\r\n        const newToggles = { ...prev };\r\n        delete newToggles[meetingId];\r\n        return newToggles;\r\n      });\r\n    } finally {\r\n      setTogglingMeetingId(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">Lecturer Dashboard</h1>\r\n        <div className=\"text-sm text-gray-500\">Academic Year 2024/2025</div>\r\n      </div>\r\n\r\n      {/* Meeting Recap Section */}\r\n      <div className=\"card\">\r\n        <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('lecturer.meetings')}</h2>\r\n        \r\n        {meetingRecapLoading ? (\r\n          <div className=\"text-center py-8 text-gray-500\">{t('common.loading')}</div>\r\n        ) : (\r\n        <>\r\n        {/* Legend */}\r\n        <div className=\"mb-4 p-3 bg-gray-50 rounded-lg border border-gray-200\">\r\n          <h3 className=\"text-xs font-semibold text-gray-700 mb-2\">{t('student.legend')}</h3>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs\">\r\n            <div key=\"student-complete\" className=\"flex items-center gap-1.5\">\r\n              <CheckCircle className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('student.attendanceRecapComplete')}</span>\r\n            </div>\r\n            <div key=\"student-partial\" className=\"flex items-center gap-1.5\">\r\n              <CheckCircle className=\"h-4 w-4 text-orange-500 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('student.attendanceRecapPartial')}</span>\r\n            </div>\r\n            <div key=\"student-incomplete\" className=\"flex items-center gap-1.5\">\r\n              <XCircle className=\"h-4 w-4 text-gray-300 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('student.attendanceRecapIncomplete')}</span>\r\n            </div>\r\n            <div key=\"lecturer-assigned\" className=\"flex items-center gap-1.5\">\r\n              <User className=\"h-4 w-4 text-blue-600 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('lecturer.lecturerAssigned')}</span>\r\n            </div>\r\n            <div key=\"lecturer-unassigned\" className=\"flex items-center gap-1.5\">\r\n              <User className=\"h-4 w-4 text-gray-300 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('lecturer.lecturerUnassigned')}</span>\r\n            </div>\r\n            <div key=\"attendance-active\" className=\"flex items-center gap-1.5\">\r\n              <div className=\"h-2 w-2 rounded-full bg-green-600 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('lecturer.attendanceActive')}</span>\r\n            </div>\r\n            <div key=\"attendance-inactive\" className=\"flex items-center gap-1.5\">\r\n              <div className=\"h-2 w-2 rounded-full bg-gray-400 flex-shrink-0\" />\r\n              <span className=\"text-gray-600\">{t('lecturer.attendanceInactive')}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {meetingRecaps.length === 0 ? (\r\n          <div className=\"text-center py-8 text-gray-500\">No classes found for this semester</div>\r\n        ) : (\r\n          <div className=\"space-y-3\">\r\n            {meetingRecaps.map(recap => {\r\n              return (\r\n              <Card key={recap.classId} className=\"p-0 overflow-hidden\">\r\n                {/* Class Info Header */}\r\n                <div className=\"bg-gradient-to-r from-primary-50 to-secondary-50 px-3 py-2 border-b border-gray-200\">\r\n                  <div className=\"flex justify-between items-center gap-3\">\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <h4 className=\"font-semibold text-sm text-gray-900 truncate\">\r\n                        {recap.courseCode} - {recap.courseName}\r\n                      </h4>\r\n                      <p className=\"text-xs text-gray-600\">{recap.className}</p>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n                      <div className=\"text-xs text-gray-600\">\r\n                        {recap.meetings.length} meeting{recap.meetings.length !== 1 ? 's' : ''}\r\n                      </div>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                          navigate(`/class-summary/${recap.classId}?courseCode=${encodeURIComponent(recap.courseCode)}&courseName=${encodeURIComponent(recap.courseName)}&className=${encodeURIComponent(recap.className)}&sksTatapMuka=${recap.sksTatapMuka}&sksPraktek=${recap.sksPraktek}&sksPrakLapangan=${recap.sksPrakLapangan}&sksSimulasi=${recap.sksSimulasi}&from=lecturer/dashboard`);\r\n                        }}\r\n                        className=\"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors flex items-center gap-1 text-xs whitespace-nowrap\"\r\n                        title=\"View attendance matrix\"\r\n                      >\r\n                        <Users className=\"h-3.5 w-3.5\" />\r\n                        <span>Summary</span>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Meeting Grid */}\r\n                <div className=\"p-3\">\r\n                  <div className=\"flex gap-1 flex-wrap\">\r\n                    {recap.meetings.map((meeting: any) => {\r\n                      const dateStr = meeting.date\r\n                        ? meeting.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\r\n                        : ''; \r\n                      \r\n                      // Use optimistic toggle if available, otherwise use actual value\r\n                      const currentAbsensiAktif = optimisticToggles[meeting.id] !== undefined \r\n                        ? optimisticToggles[meeting.id] \r\n                        : meeting.absensiAktif;\r\n                      \r\n                      return (\r\n                        <div\r\n                          key={meeting.id}\r\n                          role=\"button\"\r\n                          tabIndex={0}\r\n                          onClick={() => {\r\n                            const meetingDateTime = meeting.date ? new Date(meeting.date) : undefined;\r\n                            console.log('LecturerDashboard Debug - Setting selectedMeeting with classId:', recap.classId);\r\n                            setSelectedMeeting({\r\n                              meetingId: meeting.id,\r\n                              classId: recap.classId,\r\n                              title: `${recap.courseCode} • ${recap.courseName}`,\r\n                              subtitle: `Week ${meeting.weekNumber}`,\r\n                              dateLabel: dateStr,\r\n                              meetingDateTime,\r\n                              topic: meeting.topic || undefined,\r\n                            });\r\n                          }}\r\n                          onKeyDown={(event) => {\r\n                            if (event.key === 'Enter' || event.key === ' ') {\r\n                              event.preventDefault();\r\n                              const meetingDateTime = meeting.date ? new Date(meeting.date) : undefined;\r\n                              console.log('LecturerDashboard Debug - Setting selectedMeeting with classId:', recap.classId);\r\n                              setSelectedMeeting({\r\n                                meetingId: meeting.id,\r\n                                classId: recap.classId,\r\n                                title: `${recap.courseCode} • ${recap.courseName}`,\r\n                                subtitle: `Week ${meeting.weekNumber}`,\r\n                                dateLabel: dateStr,\r\n                                meetingDateTime,\r\n                                topic: meeting.topic || undefined,\r\n                              });\r\n                            }\r\n                          }}\r\n                          className=\"flex flex-col items-center gap-1 p-2 rounded border border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer min-w-[80px] relative group focus:outline-none focus:ring-2 focus:ring-primary-200\"\r\n                          title={`Week ${meeting.weekNumber} - ${dateStr}${meeting.topic ? ` - ${meeting.topic}` : ''}\\nStudent Attendance: ${meeting.recordedAttendances}/${meeting.totalStudents}\\nLecturer Attendance: ${meeting.lecturerAssigned ? 'Complete' : 'Incomplete'}\\nAttendance: ${meeting.absensiAktif ? 'Active' : 'Inactive'}`}\r\n                        >\r\n                          <div className=\"text-xs font-semibold text-gray-600\">{meeting.weekNumber}</div>\r\n                          \r\n                          {/* Status Icons */}\r\n                          <div className=\"flex gap-1 items-center justify-center h-6\">\r\n                            {/* Student Attendance Status */}\r\n                            {meeting.studentAttendanceComplete ? (\r\n                              <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                            ) : meeting.recordedAttendances > 0 ? (\r\n                              <CheckCircle className=\"h-4 w-4 text-orange-500\" />\r\n                            ) : (\r\n                              <XCircle className=\"h-4 w-4 text-gray-300\" />\r\n                            )}\r\n                            \r\n                            {/* Lecturer Attendance Status (Complete if lecturer assigned) */}\r\n                            {meeting.lecturerAssigned ? (\r\n                              <User className=\"h-4 w-4 text-blue-600\" />\r\n                            ) : (\r\n                              <User className=\"h-4 w-4 text-gray-300\" />\r\n                            )}\r\n                          </div>\r\n                          \r\n                          <div className=\"text-xs text-gray-500 text-center leading-tight\">\r\n                            {dateStr || '-'}\r\n                          </div>\r\n                          \r\n                          {/* Attendance activation status */}\r\n                          <div className=\"flex items-center justify-center gap-1\">\r\n                            <div className={`h-2 w-2 rounded-full ${currentAbsensiAktif ? 'bg-green-600' : 'bg-gray-400'}`} />\r\n                          </div>\r\n                          \r\n                          {/* Toggle Attendance Button */}\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={(e) => handleToggleAttendance(e, meeting.id, currentAbsensiAktif)}\r\n                            disabled={togglingMeetingId === meeting.id}\r\n                            aria-label={currentAbsensiAktif ? 'Deactivate attendance' : 'Activate attendance'}\r\n                            onMouseEnter={(e) => {\r\n                              (e.currentTarget as HTMLButtonElement).style.opacity = '1';\r\n                            }}\r\n                            onMouseLeave={(e) => {\r\n                              (e.currentTarget as HTMLButtonElement).style.opacity = '0.25';\r\n                            }}\r\n                            className=\"absolute bottom-1 right-1 p-1.5 rounded bg-white border border-gray-200 hover:bg-gray-50 disabled:opacity-50 transition-opacity shadow-sm cursor-pointer\"\r\n                            style={{ opacity: 0.25 }}\r\n                            title={currentAbsensiAktif ? 'Deactivate Attendance' : 'Activate Attendance'}\r\n                          >\r\n                            {togglingMeetingId === meeting.id ? (\r\n                              <Loader className=\"h-3.5 w-3.5 text-gray-600 animate-spin\" />\r\n                            ) : (\r\n                              <div className={`h-3.5 w-3.5 rounded-full border-2 ${currentAbsensiAktif ? 'bg-green-600 border-green-600' : 'border-gray-300'}`} />\r\n                            )}\r\n                          </button>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n        </>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"card\">\r\n        <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">{t('lecturerDashboard.thisWeekSchedule')}</h2>\r\n        {loading ? (\r\n          <div className=\"text-center py-8 text-gray-500\">{t('lecturerDashboard.loadingSchedule')}</div>\r\n        ) : thisWeekItems.length === 0 ? (\r\n          <div className=\"text-center py-8 text-gray-500\">{t('lecturerDashboard.noClasses')}</div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {thisWeekItems.map(item => {\r\n              // Combine date and time to create meeting datetime\r\n              const meetingDateTime = item.actualDate ? new Date(item.actualDate) : null;\r\n              if (meetingDateTime && item.startTime) {\r\n                const [hours, minutes] = item.startTime.split(':').map(Number);\r\n                meetingDateTime.setHours(hours, minutes, 0, 0);\r\n              }\r\n\r\n              return (\r\n              <button\r\n                key={item.id}\r\n                type=\"button\"\r\n                onClick={() =>\r\n                  setSelectedMeeting({\r\n                    meetingId: item.meetingId,\r\n                    classId: item.classId,\r\n                    title: `${item.courseCode} • ${item.courseName}`,\r\n                    subtitle: `Week ${item.weekNumber}`,\r\n                    dateLabel: item.actualDate?.toLocaleDateString('id-ID', {\r\n                      weekday: 'short',\r\n                      day: 'numeric',\r\n                      month: 'short',\r\n                    }),\r\n                    meetingDateTime: meetingDateTime || undefined,\r\n                    topic: item.topic || undefined,\r\n                  })\r\n                }\r\n                className=\"text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors flex flex-col cursor-pointer\"\r\n              >\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-start justify-between gap-2 mb-2\">\r\n                    <div className=\"flex items-center gap-2 flex-wrap\">\r\n                      <span className=\"inline-block px-2.5 py-0.5 bg-primary-100 text-primary-700 text-xs font-semibold rounded\">\r\n                        {item.weekDay}\r\n                      </span>\r\n                      {item.actualDate && (\r\n                        <span className=\"text-xs text-gray-500 px-2 py-0.5 bg-gray-100 rounded\">\r\n                          {item.actualDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' })}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                      <span className=\"text-xs text-gray-500\">{t('lecturerDashboard.week')} {item.weekNumber}</span>\r\n                  </div>\r\n                  <div className=\"text-xs font-semibold text-primary-600 mb-1\">{item.courseCode}</div>\r\n                  <h3 className=\"text-xs font-medium text-gray-900 line-clamp-2 mb-1\">{item.courseName}</h3>\r\n                </div>\r\n                <div className=\"flex flex-col gap-1 text-xs text-gray-600 border-t border-gray-100 pt-2 mt-2\">\r\n                  <div className=\"flex items-center gap-1.5\">\r\n                    <Clock className=\"h-3 w-3 flex-shrink-0\" />\r\n                    <span>{item.startTime} - {item.endTime}</span>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <AttendanceModal\r\n        selectedMeeting={selectedMeeting}\r\n        onClose={() => setSelectedMeeting(null)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LecturerDashboard;\r\n"],"names":["getDayFromDate","dateValue","date","extractDate","dayIndex","getTimeFromDate","dateStr","extractString","timeOnlyMatch","hh","mm","afterT","part","d","getCurrentWeekRange","today","dayOfWeek","daysToSunday","start","end","LecturerDashboard","user","currentSemester","useAuth","t","useTranslation","navigate","useNavigate","queryClient","useQueryClient","thisWeekItems","setThisWeekItems","useState","selectedMeeting","setSelectedMeeting","togglingMeetingId","setTogglingMeetingId","optimisticToggles","setOptimisticToggles","useEffect","enabled","logger","React","startDay","endDay","rawClasses","loading","useLecturerClasses","meetingRecapQueryEnabled","meetingRecapData","meetingRecapLoading","useQuery","apiService","err","meetingRecaps","useMemo","classData","meetings","meeting","computedWeekNumber","recordedRaw","recorded","acRaw","studentComplete","lecturerAssigned","a","b","aDate","bDate","c","m","items","day","startTime","actualDate","totalSKS","durationMinutes","startHours","startMinutes","totalMinutes","endHours","endMinutes","endTime","weekItems","item","weekDayIndex","handleToggleAttendance","e","meetingId","currentStatus","prev","newToggles","error","jsxs","jsx","Fragment","CheckCircle","XCircle","User","recap","Card","Users","currentAbsensiAktif","meetingDateTime","event","Loader","hours","minutes","Clock","AttendanceModal"],"mappings":"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"}