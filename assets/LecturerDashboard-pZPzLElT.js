import{j as e}from"./query-vendor-B--u1oZD.js";import{r as g,g as k}from"./react-vendor-XXJdR_Id.js";import{u as E,e as b,c as h}from"./index-U_9acvuP.js";import{c as F}from"./useClasses-Ct6ZdiuQ.js";import{A as O}from"./AttendanceModal-Dh8-EeX1.js";import{e as B,B as R,g as v,b as K}from"./ui-vendor-C-UqR_Df.js";import"./status-sB_rSvKV.js";import"./useLecturerAssignments-DiRZGo_n.js";const U=d=>{const r=b(d);if(!r)return null;const n=r.getDay();return{1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday"}[n]||null},P=d=>{const r=h(d);if(!r)return"00:00";const n=r.split("T")[1]?.split(".")[0]||r.split("T")[1]?.split("Z")[0];return n?n.substring(0,5):new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},Y=()=>{const d=new Date,r=d.getDay(),n=r===0?0:r,c=new Date(d);c.setDate(d.getDate()-n),c.setHours(0,0,0,0);const i=new Date(c);return i.setDate(c.getDate()+6),i.setHours(23,59,59,999),{start:c,end:i}},ee=()=>{const{user:d,currentSemester:r}=E(),[n,c]=g.useState([]),[i,p]=g.useState(null),{start:D,end:w}=k.useMemo(()=>Y(),[]),S=D.toISOString().split("T")[0],T=w.toISOString().split("T")[0],{data:m,isLoading:o}=F(d?.employeeId||"",{semester:r,start_day:S,end_day:T}),x=k.useMemo(()=>m??[],[m]);g.useEffect(()=>{const s=[];(m??[]).forEach(t=>{t.meeting_schedules.forEach(a=>{const u=U(a.tgl_pertemuan);if(!u)return;const y=P(a.jam_pertemuan),N=b(a.tgl_pertemuan);if(!N)return;const j=t.sks_tatap_muka+t.sks_praktek+t.sks_prak_lapangan+t.sks_simulasi,C=j*60,[W,L]=y.split(":").map(Number),f=W*60+L+C,H=Math.floor(f/60)%24,$=f%60,A=`${String(H).padStart(2,"0")}:${String($).padStart(2,"0")}`;s.push({id:`${t.kelas_id}-${a.id}`,day:u,startTime:y,endTime:A,courseCode:t.kode_mk,courseName:t.nama_mk,className:t.nama_kelas,credits:j,room:h(a.media_pembelajaran,"TBA"),topic:h(a.topik,""),weekNumber:a.pertemuan_ke,classId:t.kelas_id,actualDate:N,meetingId:a.id})})});const l=s.filter(t=>t.actualDate).map(t=>{const a=t.actualDate.getDay();return{...t,weekDay:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}[a]||"Monday"}}).sort((t,a)=>!t.actualDate||!a.actualDate?0:t.actualDate.getTime()-a.actualDate.getTime());c(l)},[m]);const _=x.reduce(s=>s+30,0),M=x.length,I=x.reduce((s,l)=>{const t=l.sks_tatap_muka+l.sks_praktek+l.sks_prak_lapangan+l.sks_simulasi;return s+t},0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lecturer Dashboard"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Academic Year 2024/2025"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:e.jsx(B,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Students"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o?"...":_})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(R,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Active Classes"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o?"...":M})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(v,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Teaching Hours"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o?"...":I})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(K,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"This Week Classes"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o?"...":n.length})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"This Week's Schedule"}),o?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading this week's schedule..."}):n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No classes scheduled for this week"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>{const l=s.actualDate?new Date(s.actualDate):null;if(l&&s.startTime){const[t,a]=s.startTime.split(":").map(Number);l.setHours(t,a,0,0)}return e.jsxs("button",{type:"button",onClick:()=>p({meetingId:s.meetingId,classId:s.classId,title:`${s.courseCode} â€¢ ${s.courseName}`,subtitle:`Week ${s.weekNumber}`,dateLabel:s.actualDate?.toLocaleDateString("id-ID",{weekday:"short",day:"numeric",month:"short"}),meetingDateTime:l||void 0,topic:s.topic||void 0}),className:"text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors flex flex-col cursor-pointer",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"inline-block px-2.5 py-0.5 bg-primary-100 text-primary-700 text-xs font-semibold rounded",children:s.weekDay}),s.actualDate&&e.jsx("span",{className:"text-xs text-gray-500 px-2 py-0.5 bg-gray-100 rounded",children:s.actualDate.toLocaleDateString("id-ID",{day:"numeric",month:"short"})})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Week ",s.weekNumber]})]}),e.jsx("div",{className:"text-xs font-semibold text-primary-600 mb-1",children:s.courseCode}),e.jsx("h3",{className:"text-xs font-medium text-gray-900 line-clamp-2 mb-1",children:s.courseName})]}),e.jsx("div",{className:"flex flex-col gap-1 text-xs text-gray-600 border-t border-gray-100 pt-2 mt-2",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(v,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{children:[s.startTime," - ",s.endTime]})]})})]},s.id)})})]}),e.jsx(O,{selectedMeeting:i,onClose:()=>p(null)})]})};export{ee as default};
//# sourceMappingURL=LecturerDashboard-pZPzLElT.js.map
