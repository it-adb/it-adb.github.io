{"version":3,"file":"ClassSchedule-DVx7KzVx.js","sources":["../../src/pages/student/ClassSchedule.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { CalendarDays, Clock, MapPin, AlertCircle, CheckCircle, Loader2 } from 'lucide-react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport type { StudentAttendanceResponse } from '../../types';\r\nimport { useStudentClasses, useStudentAttendances } from '../../hooks/useClasses';\r\nimport { extractString, extractDate } from '../../utils/sqlNull';\r\nimport { getStatusDisplayLabel } from '@/utils';\r\nimport CheckInModal from '../../components/shared/CheckInModal';\r\n\r\ntype Day = 'Monday' | 'Tuesday' | 'Wednesday' | 'Thursday' | 'Friday';\r\n\r\ninterface ScheduleItem {\r\n  id: string;\r\n  day: Day;\r\n  startTime: string; // HH:mm\r\n  endTime: string;   // HH:mm\r\n  courseCode: string;\r\n  courseName: string;\r\n  className: string;\r\n  credits: number;\r\n  room: string;\r\n  topic: string;\r\n  weekNumber: number;\r\n  classId: number;\r\n  actualDate?: Date; // Store the actual meeting date\r\n  meetingId: number; // For attendance check-in\r\n}\r\n\r\n// Helper to extract day name from date string\r\nconst getDayFromDate = (dateValue: unknown): Day | null => {\r\n  const date = extractDate(dateValue as any);\r\n  if (!date) return null;\r\n  const dayIndex = date.getDay();\r\n  const daysMap: Record<number, Day> = {\r\n    1: 'Monday',\r\n    2: 'Tuesday',\r\n    3: 'Wednesday',\r\n    4: 'Thursday',\r\n    5: 'Friday',\r\n  };\r\n  return daysMap[dayIndex] || null;\r\n};\r\n\r\n// Helper to extract time from datetime string (handles backend format like \"0000-01-01T11:00:00Z\")\r\nconst getTimeFromDate = (dateValue: unknown): string => {\r\n  const dateStr = extractString(dateValue as any);\r\n  if (!dateStr) return '00:00';\r\n  \r\n  // Backend stores time in format \"0000-01-01THH:mm:ss.000Z\", extract the time portion\r\n  const timePart = dateStr.split('T')[1]?.split('.')[0] || dateStr.split('T')[1]?.split('Z')[0];\r\n  if (timePart) {\r\n    // Return HH:mm format\r\n    return timePart.substring(0, 5);\r\n  }\r\n  // Fallback to parsing the full date\r\n  const date = new Date(dateStr);\r\n  return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });\r\n};\r\n\r\nconst ClassSchedule: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [scheduleItems, setScheduleItems] = useState<ScheduleItem[]>([]);\r\n  \r\n  // Filter and sort state for List of Schedules\r\n  const [selectedCourses, setSelectedCourses] = useState<string[]>([]);\r\n  const [filterStartDate, setFilterStartDate] = useState<string>('');\r\n  const [filterEndDate, setFilterEndDate] = useState<string>('');\r\n  \r\n  // Check-in modal state\r\n  const [showCheckInModal, setShowCheckInModal] = useState(false);\r\n  const [checkInMeetingId, setCheckInMeetingId] = useState<number | null>(null);\r\n  const [checkInCourseName, setCheckInCourseName] = useState('');\r\n\r\n  // Build API params with date filters\r\n  const params = React.useMemo(() => {\r\n    const p: { semester?: string; start_day?: string; end_day?: string } = {};\r\n    if (filterStartDate) p.start_day = filterStartDate;\r\n    if (filterEndDate) p.end_day = filterEndDate;\r\n    return p;\r\n  }, [filterStartDate, filterEndDate]);\r\n\r\n  // Fetch classes with date filters\r\n  const { data: rawClasses, isLoading: loading, error: fetchError } = useStudentClasses(\r\n    user?.studentId || '',\r\n    params\r\n  );\r\n  // Avoid rendering-time default [] that changes identity on every render while loading\r\n  const classes = React.useMemo(() => rawClasses ?? [], [rawClasses]);\r\n\r\n  // Fetch attendances\r\n  const { data: attendances = [] } = useStudentAttendances();\r\n\r\n  const error = fetchError ? (fetchError instanceof Error ? fetchError.message : 'Failed to load class schedule') : null;\r\n\r\n  const openCheckInModal = (meetingId: number, courseName: string) => {\r\n    setCheckInMeetingId(meetingId);\r\n    setCheckInCourseName(courseName);\r\n    setShowCheckInModal(true);\r\n  };\r\n\r\n  const closeCheckInModal = () => {\r\n    setShowCheckInModal(false);\r\n    setCheckInMeetingId(null);\r\n    setCheckInCourseName('');\r\n  };\r\n\r\n  const isCheckedIn = (meetingId: number): boolean => {\r\n    return Array.isArray(attendances) && attendances.some(att => att.id_pertemuan === meetingId);\r\n  };\r\n\r\n  const getAttendanceInfo = (meetingId: number): StudentAttendanceResponse | undefined => {\r\n    return Array.isArray(attendances) ? attendances.find(att => att.id_pertemuan === meetingId) : undefined;\r\n  };\r\n\r\n  const canCheckIn = (item: ScheduleItem): { allowed: boolean; reason?: string } => {\r\n    if (!item.actualDate) {\r\n      return { allowed: false, reason: 'Invalid meeting date' };\r\n    }\r\n\r\n    // Check if already checked in\r\n    if (isCheckedIn(item.meetingId)) {\r\n      return { allowed: false, reason: 'Already checked in' };\r\n    }\r\n\r\n    // Parse meeting time\r\n    const [hours, minutes] = item.startTime.split(':').map(Number);\r\n    const meetingDateTime = new Date(item.actualDate);\r\n    meetingDateTime.setHours(hours, minutes, 0, 0);\r\n\r\n    // Check if current time is at least 5 minutes before the meeting\r\n    const now = new Date();\r\n    const fiveMinutesBeforeMeeting = new Date(meetingDateTime.getTime() - 5 * 60 * 1000);\r\n\r\n    if (now < fiveMinutesBeforeMeeting) {\r\n      return { \r\n        allowed: false\r\n      };\r\n    }\r\n\r\n    return { allowed: true };\r\n  };\r\n\r\n  const getAttendanceColors = (status: string): { border: string; bg: string; text: string; icon: string } => {\r\n    const normalizedStatus = status.toLowerCase();\r\n    if (normalizedStatus === 'hadir') {\r\n      return { \r\n        border: 'border-green-300', \r\n        bg: 'bg-green-50', \r\n        text: 'text-green-700', \r\n        icon: 'text-green-600' \r\n      };\r\n    } else if (normalizedStatus === 'izin' || normalizedStatus === 'sakit') {\r\n      return { \r\n        border: 'border-yellow-300', \r\n        bg: 'bg-yellow-50', \r\n        text: 'text-yellow-700', \r\n        icon: 'text-yellow-600' \r\n      };\r\n    } else if (normalizedStatus === 'alfa') {\r\n      return { \r\n        border: 'border-red-300', \r\n        bg: 'bg-red-50', \r\n        text: 'text-red-700', \r\n        icon: 'text-red-600' \r\n      };\r\n    } else if (normalizedStatus === 'terlambat') {\r\n      return { \r\n        border: 'border-orange-300', \r\n        bg: 'bg-orange-50', \r\n        text: 'text-orange-700', \r\n        icon: 'text-orange-600' \r\n      };\r\n    } else if (normalizedStatus === 'pengganti') {\r\n      return {\r\n        border: 'border-purple-300',\r\n        bg: 'bg-purple-50',\r\n        text: 'text-purple-700',\r\n        icon: 'text-purple-600'\r\n      };\r\n    }\r\n    // Default to green for unknown status\r\n    return { \r\n      border: 'border-green-300', \r\n      bg: 'bg-green-50', \r\n      text: 'text-green-700', \r\n      icon: 'text-green-600' \r\n    };\r\n  };\r\n\r\n  const formatDateTime = (dateString: string | null | undefined): { date: string; time: string } | null => {\r\n    if (!dateString) return null;\r\n    try {\r\n      const date = new Date(dateString);\r\n      if (isNaN(date.getTime())) return null;\r\n      \r\n      return {\r\n        date: date.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' }),\r\n        time: date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false })\r\n      };\r\n    } catch {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // Process classes data whenever classes changes\r\n  useEffect(() => {\r\n    // Convert meeting schedules to schedule items\r\n    const items: ScheduleItem[] = [];\r\n    (rawClasses ?? []).forEach(classData => {\r\n          classData.meeting_schedules.forEach(meeting => {\r\n            const day = getDayFromDate(meeting.tgl_pertemuan);\r\n            \r\n            // Skip if day is Saturday or Sunday (null)\r\n            if (!day) return;\r\n            \r\n            const startTime = getTimeFromDate(meeting.jam_pertemuan);\r\n            const actualDate = extractDate(meeting.tgl_pertemuan);\r\n            \r\n            // Skip if no valid date\r\n            if (!actualDate) return;\r\n            \r\n            // Calculate end time based on credits (assuming 1 SKS = 50 minutes)\r\n            const totalSKS = classData.sks_tatap_muka + classData.sks_praktek + classData.sks_prak_lapangan + classData.sks_simulasi;\r\n            const durationMinutes = totalSKS * 60;\r\n            \r\n            // Parse start time and add duration\r\n            const [startHours, startMinutes] = startTime.split(':').map(Number);\r\n            const totalMinutes = startHours * 60 + startMinutes + durationMinutes;\r\n            const endHours = Math.floor(totalMinutes / 60) % 24;\r\n            const endMinutes = totalMinutes % 60;\r\n            const endTime = `${String(endHours).padStart(2, '0')}:${String(endMinutes).padStart(2, '0')}`;\r\n\r\n            items.push({\r\n              id: `${classData.kelas_id}-${meeting.id}`,\r\n              day,\r\n              startTime,\r\n              endTime,\r\n              courseCode: classData.kode_mk,\r\n              courseName: classData.nama_mk,\r\n              className: classData.nama_kelas,\r\n              credits: totalSKS,\r\n              room: extractString(meeting.media_pembelajaran, 'TBA'),\r\n              topic: extractString(meeting.topik, ''),\r\n              weekNumber: meeting.pertemuan_ke,\r\n              classId: classData.kelas_id,\r\n              actualDate,\r\n              meetingId: meeting.id,\r\n            });\r\n          });\r\n        });\r\n    setScheduleItems(items);\r\n  }, [rawClasses]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto space-y-6\">\r\n        <div className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary-600 mx-auto mb-2\" />\r\n            <p className=\"text-gray-600\">Loading class schedule...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto space-y-6\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">Class & Schedule</h1>\r\n        <div className=\"card bg-red-50 border-red-200\">\r\n          <div className=\"flex items-center space-x-3 text-red-800\">\r\n            <AlertCircle className=\"h-5 w-5 flex-shrink-0\" />\r\n            <div>\r\n              <p className=\"font-medium\">Error loading schedule</p>\r\n              <p className=\"text-sm mt-1\">{error}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto space-y-4 lg:space-y-6\">\r\n      <h1 className=\"text-xl lg:text-2xl font-bold text-gray-900\">Class & Schedule</h1>\r\n\r\n      {/* Summary */}\r\n      <div className=\"card grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 lg:gap-4\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <CalendarDays className=\"h-5 w-5 text-primary-600 flex-shrink-0\" />\r\n          <div>\r\n            <div className=\"text-xs lg:text-sm text-gray-500\">Classes Enrolled</div>\r\n            <div className=\"text-base lg:text-lg font-semibold\">{classes.length} classes</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          <Clock className=\"h-5 w-5 text-green-600 flex-shrink-0\" />\r\n          <div>\r\n            <div className=\"text-xs lg:text-sm text-gray-500\">Total Meetings</div>\r\n            <div className=\"text-base lg:text-lg font-semibold\">{scheduleItems.length} sessions</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3 sm:col-span-2 lg:col-span-1\">\r\n          <MapPin className=\"h-5 w-5 text-blue-600 flex-shrink-0\" />\r\n          <div>\r\n            <div className=\"text-xs lg:text-sm text-gray-500\">Total Credits</div>\r\n            <div className=\"text-base lg:text-lg font-semibold\">\r\n              {classes.reduce((sum, c) => sum + c.sks_tatap_muka + c.sks_praktek + c.sks_prak_lapangan + c.sks_simulasi, 0)} SKS\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {classes.length === 0 ? (\r\n        <div className=\"card text-center py-12\">\r\n          <CalendarDays className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No Classes Found</h3>\r\n          <p className=\"text-gray-600\">\r\n            You are not enrolled in any classes.\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Class List */}\r\n          <div className=\"card\">\r\n            <h2 className=\"text-base lg:text-lg font-semibold text-gray-900 mb-3 lg:mb-4\">Enrolled Classes</h2>\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3\">\r\n              {classes.map(classData => {\r\n                const totalSKS = classData.sks_tatap_muka + classData.sks_praktek + classData.sks_prak_lapangan + classData.sks_simulasi;\r\n                const meetingCount = classData.meeting_schedules.length;\r\n                \r\n                return (\r\n                  <div key={classData.kelas_id} className=\"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors flex flex-col\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 flex-wrap mb-2\">\r\n                        <span className=\"text-xs font-semibold text-primary-600\">{classData.kode_mk}</span>\r\n                      </div>\r\n                      <h3 className=\"text-xs font-medium text-gray-900 line-clamp-2 mb-1\">{classData.nama_mk}</h3>\r\n                      {classData.bahasan && (\r\n                        <p className=\"text-xs text-gray-600 line-clamp-2 mb-2\">{classData.bahasan}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center flex-wrap gap-x-2 gap-y-0.5 text-xs text-gray-500 border-t border-gray-100 pt-2\">\r\n                      <span className=\"font-medium text-gray-700\">{totalSKS} SKS</span>\r\n                      <span>•</span>\r\n                      <span>{meetingCount} meetings</span>\r\n                      {classData.mode_kuliah && (\r\n                        <>\r\n                          <span className=\"hidden sm:inline\">•</span>\r\n                          <span className=\"text-gray-600 hidden sm:inline\">{classData.mode_kuliah}</span>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* List of Schedules */}\r\n          <div className=\"card\">\r\n            <div className=\"flex items-center justify-between mb-3 lg:mb-4 flex-wrap gap-3\">\r\n              <h2 className=\"text-base lg:text-lg font-semibold text-gray-900\">List of Schedules</h2>\r\n            </div>\r\n\r\n            {/* Filter and Sort Controls */}\r\n            <div className=\"mb-4 lg:mb-6 pb-3 lg:pb-4 border-b border-gray-200\">\r\n              <div className=\"space-y-4\">\r\n                {/* Course Filter */}\r\n                <div>\r\n                  <label className=\"block text-xs font-semibold text-gray-700 mb-2 lg:mb-3\">Filter by Course</label>\r\n                  <div className=\"flex gap-2 flex-wrap\">\r\n                    {Array.from(new Set(scheduleItems.map(item => item.courseCode))).map(code => {\r\n                      const courseName = scheduleItems.find(item => item.courseCode === code)?.courseName;\r\n                      const isSelected = selectedCourses.includes(code);\r\n                      return (\r\n                        <button\r\n                          key={code}\r\n                          onClick={() => {\r\n                            if (isSelected) {\r\n                              setSelectedCourses(selectedCourses.filter(c => c !== code));\r\n                            } else {\r\n                              setSelectedCourses([...selectedCourses, code]);\r\n                            }\r\n                          }}\r\n                          className={`px-2.5 lg:px-3 py-1.5 text-xs font-medium rounded-lg transition-all cursor-pointer ${\r\n                            isSelected\r\n                              ? 'bg-primary-600 text-white border border-primary-600 hover:bg-primary-700'\r\n                              : 'bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200 hover:border-gray-300'\r\n                          }`}\r\n                          title={`${code} - ${courseName}`}\r\n                          type=\"button\"\r\n                        >\r\n                          <span className=\"hidden sm:inline\">{code} - {courseName}</span>\r\n                          <span className=\"sm:hidden\">{courseName}</span>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Date Filter */}\r\n                <div>\r\n                  <label className=\"block text-xs font-semibold text-gray-700 mb-2 lg:mb-3\">Filter by Date</label>\r\n                  <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-3\">\r\n                    <div className=\"flex-1\">\r\n                      <input\r\n                        type=\"date\"\r\n                        value={filterStartDate}\r\n                        onChange={(e) => setFilterStartDate(e.target.value)}\r\n                        className=\"input-field w-full text-xs\"\r\n                        placeholder=\"Start date\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                      <input\r\n                        type=\"date\"\r\n                        value={filterEndDate}\r\n                        onChange={(e) => setFilterEndDate(e.target.value)}\r\n                        className=\"input-field w-full text-xs\"\r\n                        placeholder=\"End date\"\r\n                      />\r\n                    </div>\r\n                    {(filterStartDate || filterEndDate) && (\r\n                      <button\r\n                        onClick={() => {\r\n                          setFilterStartDate('');\r\n                          setFilterEndDate('');\r\n                        }}\r\n                        className=\"px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-200 rounded-lg hover:bg-gray-200 hover:border-gray-300 transition-all cursor-pointer whitespace-nowrap\"\r\n                        type=\"button\"\r\n                      >\r\n                        Clear Dates\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Schedule Table */}\r\n            {(() => {\r\n              let filtered = scheduleItems;\r\n              \r\n              if (selectedCourses.length > 0) {\r\n                filtered = filtered.filter(item => selectedCourses.includes(item.courseCode));\r\n              }\r\n\r\n              // Note: Date filtering is now handled by the backend via start_day and end_day parameters\r\n\r\n              // Sort by date\r\n              const sorted = [...filtered].sort((a, b) => {\r\n                if (!a.actualDate || !b.actualDate) return 0;\r\n                \r\n                // First, compare by date\r\n                const dateComparison = a.actualDate.getTime() - b.actualDate.getTime();\r\n                if (dateComparison !== 0) return dateComparison;\r\n                \r\n                // If dates are the same, compare by time\r\n                return a.startTime.localeCompare(b.startTime);\r\n              });\r\n\r\n              if (sorted.length === 0) {\r\n                return (\r\n                  <div className=\"text-center py-12\">\r\n                    <CalendarDays className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n                    <p className=\"text-gray-600\">No meetings match the selected filters.</p>\r\n                  </div>\r\n                );\r\n              }\r\n\r\n              return (\r\n                <div className=\"space-y-3\">\r\n                  {/* Mobile Card View */}\r\n                  <div className=\"lg:hidden space-y-2\">\r\n                    {sorted.map((item, index) => {\r\n                      const classData = classes.find(c => c.kelas_id === item.classId);\r\n                      const meeting = classData?.meeting_schedules.find(\r\n                        m => `${classData.kelas_id}-${m.id}` === item.id\r\n                      );\r\n                      const meetingDateObj = meeting ? extractDate(meeting.tgl_pertemuan) : null;\r\n                      const meetingDate = meetingDateObj ? meetingDateObj.toLocaleDateString('id-ID', { \r\n                        day: 'numeric', \r\n                        month: 'short',\r\n                        year: 'numeric'\r\n                      }) : '';\r\n                      \r\n                      const checkedIn = isCheckedIn(item.meetingId);\r\n                      const checkInStatus = canCheckIn(item);\r\n                      const attendanceInfo = getAttendanceInfo(item.meetingId);\r\n                      const colors = attendanceInfo ? getAttendanceColors(attendanceInfo.status_kehadiran) : null;\r\n\r\n                      return (\r\n                        <div\r\n                          key={`${item.id}-${index}-mobile`}\r\n                          className={`p-3 border rounded-lg ${\r\n                            checkedIn && colors\r\n                              ? `${colors.border} ${colors.bg}`\r\n                              : 'border-gray-200 bg-white'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-start justify-between gap-2 mb-2\">\r\n                            <div className=\"flex items-center gap-2 flex-wrap\">\r\n                              <span className=\"inline-block px-2 py-0.5 bg-primary-100 text-primary-700 text-xs font-semibold rounded\">\r\n                                {item.day}\r\n                              </span>\r\n                              <span className=\"text-xs text-gray-600\">{meetingDate}</span>\r\n                            </div>\r\n                            {checkedIn && colors && (\r\n                              <CheckCircle className={`h-4 w-4 ${colors.icon} flex-shrink-0`} />\r\n                            )}\r\n                          </div>\r\n\r\n                          <div className=\"space-y-1.5\">\r\n                            <div className=\"flex items-start gap-2\">\r\n                              <span className=\"text-xs font-semibold text-primary-600 flex-shrink-0\">{item.courseCode}</span>\r\n                              <span className=\"text-xs font-medium text-gray-900\">{item.courseName}</span>\r\n                            </div>\r\n                            \r\n                            <div className=\"flex items-center gap-2 text-xs text-gray-600\">\r\n                              <span>Week {item.weekNumber}</span>\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center gap-3 text-xs text-gray-600\">\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Clock className=\"h-3 w-3\" />\r\n                                <span>{item.startTime} - {item.endTime}</span>\r\n                              </div>\r\n                            </div>\r\n\r\n                            {checkedIn && attendanceInfo && colors ? (\r\n                              <div className={`text-xs ${colors.text} font-medium pt-2 border-t ${colors.border}`}>\r\n                                {(() => {\r\n                                  const checkInTime = formatDateTime(attendanceInfo.waktu_masuk);\r\n                                  if (!checkInTime) return '✓ Checked in';\r\n                                  return `✓ Checked in: ${checkInTime.date} ${checkInTime.time} (${getStatusDisplayLabel(attendanceInfo.status_kehadiran)})`;\r\n                                })()}\r\n                              </div>\r\n                            ) : checkInStatus.allowed ? (\r\n                              <button\r\n                                onClick={() => openCheckInModal(item.meetingId, item.courseName)}\r\n                                className=\"w-full text-xs px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-all cursor-pointer font-medium mt-2\"\r\n                                type=\"button\"\r\n                              >\r\n                                Check In\r\n                              </button>\r\n                            ) : (\r\n                              <div className=\"text-xs text-gray-500 italic text-center py-1 mt-2\">\r\n                                {checkInStatus.reason}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n\r\n                  {/* Desktop Table View */}\r\n                  <div className=\"hidden lg:block overflow-x-auto\">\r\n                  <table className=\"w-full text-xs\">\r\n                    <thead>\r\n                      <tr className=\"border-b-2 border-gray-300 bg-gray-50\">\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Status</th>\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Day</th>\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Date</th>\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Time</th>\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Course Code</th>\r\n                        <th className=\"px-3 py-2 text-left font-semibold text-gray-700\">Course Name</th>\r\n                        <th className=\"px-3 py-2 text-center font-semibold text-gray-700\">Week</th>\r\n                        <th className=\"px-3 py-2 text-center font-semibold text-gray-700\">Action</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {sorted.map((item, index) => {\r\n                        // Find the actual meeting to get the date\r\n                        const classData = classes.find(c => c.kelas_id === item.classId);\r\n                        const meeting = classData?.meeting_schedules.find(\r\n                          m => `${classData.kelas_id}-${m.id}` === item.id\r\n                        );\r\n                        const meetingDateObj = meeting ? extractDate(meeting.tgl_pertemuan) : null;\r\n                        const meetingDate = meetingDateObj ? meetingDateObj.toLocaleDateString('id-ID', { \r\n                          day: 'numeric', \r\n                          month: 'short',\r\n                          year: 'numeric'\r\n                        }) : '';\r\n                        \r\n                        const isEvenRow = index % 2 === 0;\r\n                        const checkedIn = isCheckedIn(item.meetingId);\r\n                        const checkInStatus = canCheckIn(item);\r\n                        const attendanceInfo = getAttendanceInfo(item.meetingId);\r\n                        const colors = attendanceInfo ? getAttendanceColors(attendanceInfo.status_kehadiran) : null;\r\n\r\n                        return (\r\n                          <tr\r\n                            key={`${item.id}-${index}`}\r\n                            className={`border-b border-gray-200 transition-colors ${\r\n                              checkedIn && colors\r\n                                ? colors.bg\r\n                                : isEvenRow \r\n                                ? 'bg-white hover:bg-blue-50' \r\n                                : 'bg-gray-50 hover:bg-blue-50'\r\n                            }`}\r\n                          >\r\n                            <td className=\"px-3 py-2 text-center\">\r\n                              {checkedIn && colors && (\r\n                                <CheckCircle className={`h-4 w-4 ${colors.icon} inline`} />\r\n                              )}\r\n                            </td>\r\n                            <td className=\"px-3 py-2 whitespace-nowrap\">\r\n                              <span className=\"inline-block px-2 py-0.5 bg-primary-100 text-primary-700 font-semibold rounded\">\r\n                                {item.day}\r\n                              </span>\r\n                            </td>\r\n                            <td className=\"px-3 py-2 whitespace-nowrap text-gray-600\">\r\n                              {meetingDate}\r\n                            </td>\r\n                            <td className=\"px-3 py-2 whitespace-nowrap text-gray-600\">\r\n                              {item.startTime} - {item.endTime}\r\n                            </td>\r\n                            <td className=\"px-3 py-2 whitespace-nowrap font-semibold text-primary-600\">\r\n                              {item.courseCode}\r\n                            </td>\r\n                            <td className=\"px-3 py-2 max-w-xs\">\r\n                              <div className=\"truncate text-gray-900 font-medium\">\r\n                                {item.courseName}\r\n                              </div>\r\n                            </td>\r\n                            <td className=\"px-3 py-2 text-center text-gray-600 whitespace-nowrap\">\r\n                              {item.weekNumber}\r\n                            </td>\r\n                            <td className=\"px-3 py-2 text-center whitespace-nowrap\">\r\n                              {checkedIn && attendanceInfo && colors ? (\r\n                                <span className={`text-xs ${colors.text} font-medium whitespace-nowrap`}>\r\n                                  ✓ {new Date(attendanceInfo.waktu_masuk).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}{' '}\r\n                                  {new Date(attendanceInfo.waktu_masuk).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false })}{' '}\r\n                                  ({getStatusDisplayLabel(attendanceInfo.status_kehadiran)})\r\n                                </span>\r\n                              ) : checkInStatus.allowed ? (\r\n                                <button\r\n                                  onClick={() => openCheckInModal(item.meetingId, item.courseName)}\r\n                                  className=\"text-xs px-2 py-1 bg-primary-600 text-white rounded hover:bg-primary-700 transition-all cursor-pointer font-medium\"\r\n                                  type=\"button\"\r\n                                >\r\n                                  Check In\r\n                                </button>\r\n                              ) : (\r\n                                <div className=\"flex flex-col items-center gap-1\">\r\n                                  <button\r\n                                    disabled\r\n                                    className=\"text-xs px-2 py-1 bg-gray-300 text-gray-500 rounded cursor-not-allowed\"\r\n                                    title={checkInStatus.reason}\r\n                                  >\r\n                                    Check In\r\n                                  </button>\r\n                                  <span className=\"text-xs text-gray-500 italic max-w-[120px] text-center\">\r\n                                    {checkInStatus.reason}\r\n                                  </span>\r\n                                </div>\r\n                              )}\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n                </div>\r\n              );\r\n            })()}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      <CheckInModal\r\n        isOpen={showCheckInModal}\r\n        meetingId={checkInMeetingId}\r\n        courseName={checkInCourseName}\r\n        onClose={closeCheckInModal}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClassSchedule;\r\n"],"names":["getDayFromDate","dateValue","date","extractDate","dayIndex","getTimeFromDate","dateStr","extractString","timePart","ClassSchedule","user","useAuth","scheduleItems","setScheduleItems","useState","selectedCourses","setSelectedCourses","filterStartDate","setFilterStartDate","filterEndDate","setFilterEndDate","showCheckInModal","setShowCheckInModal","checkInMeetingId","setCheckInMeetingId","checkInCourseName","setCheckInCourseName","params","React","p","rawClasses","loading","fetchError","useStudentClasses","classes","attendances","useStudentAttendances","error","openCheckInModal","meetingId","courseName","closeCheckInModal","isCheckedIn","att","getAttendanceInfo","canCheckIn","item","hours","minutes","meetingDateTime","now","fiveMinutesBeforeMeeting","getAttendanceColors","status","normalizedStatus","formatDateTime","dateString","useEffect","items","classData","meeting","day","startTime","actualDate","totalSKS","durationMinutes","startHours","startMinutes","totalMinutes","endHours","endMinutes","endTime","jsx","jsxs","Loader2","AlertCircle","CalendarDays","Clock","MapPin","sum","c","Fragment","meetingCount","code","isSelected","e","filtered","sorted","a","b","dateComparison","index","m","meetingDateObj","meetingDate","checkedIn","checkInStatus","attendanceInfo","colors","CheckCircle","checkInTime","getStatusDisplayLabel","isEvenRow","CheckInModal"],"mappings":"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"}