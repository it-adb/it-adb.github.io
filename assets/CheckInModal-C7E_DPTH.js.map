{"version":3,"file":"CheckInModal-C7E_DPTH.js","sources":["../../src/components/modals/CheckInModal.tsx"],"sourcesContent":["import React from 'react';\r\nimport { X, Loader2, CheckCircle, Clock, AlertCircle, ClockAlert, XCircle } from 'lucide-react';\r\nimport { useCheckInAttendance, useUpdateCheckInAttendance } from '../../hooks/useClasses';\r\n\r\ninterface CheckInModalProps {\r\n  isOpen: boolean;\r\n  meetingId: number | null;\r\n  courseName: string;\r\n  onClose: () => void;\r\n  editMode?: boolean;\r\n  existingProof?: string;\r\n  existingDescription?: string;\r\n}\r\n\r\nconst CheckInModal: React.FC<CheckInModalProps> = ({\r\n  isOpen,\r\n  meetingId,\r\n  courseName,\r\n  onClose,\r\n  editMode = false,\r\n  existingProof = '',\r\n  existingDescription = '',\r\n}) => {\r\n  const [selectedStatus, setSelectedStatus] = React.useState<'Hadir' | 'Izin' | 'Sakit' | 'Alfa' | 'Terlambat' | 'Pengganti'>('Hadir');\r\n  const [description, setDescription] = React.useState('');\r\n  const [linkBukti, setLinkBukti] = React.useState('');\r\n\r\n  const checkInMutation = useCheckInAttendance();\r\n  const updateMutation = useUpdateCheckInAttendance();\r\n\r\n  // Reset form when modal opens\r\n  React.useEffect(() => {\r\n    if (isOpen) {\r\n      if (editMode) {\r\n        setLinkBukti(existingProof);\r\n        setDescription(existingDescription);\r\n      } else {\r\n        setSelectedStatus('Hadir');\r\n        setDescription('');\r\n        setLinkBukti('');\r\n      }\r\n    }\r\n  }, [isOpen, editMode, existingProof, existingDescription]);\r\n\r\n  const handleCheckIn = async () => {\r\n    if (editMode) {\r\n      if (!meetingId) return;\r\n      try {\r\n        await updateMutation.mutateAsync({\r\n          id_pertemuan: meetingId,\r\n          deskripsi: description.trim() || undefined,\r\n          link_bukti: linkBukti.trim() || undefined,\r\n        });\r\n        onClose();\r\n        alert('Proof and description updated successfully!');\r\n      } catch (err) {\r\n        alert(`Update failed: ${err instanceof Error ? err.message : 'Unknown error'}`);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (!meetingId || checkInMutation.isPending) return;\r\n\r\n    try {\r\n      await checkInMutation.mutateAsync({\r\n        id_pertemuan: meetingId,\r\n        status_kehadiran: selectedStatus,\r\n        deskripsi: description.trim() || undefined,\r\n        link_bukti: linkBukti.trim() || undefined\r\n      });\r\n\r\n      onClose();\r\n\r\n      const statusLabels = {\r\n        'Hadir': 'Present',\r\n        'Izin': 'Permission',\r\n        'Sakit': 'Sick',\r\n        'Alfa': 'Absent',\r\n        'Terlambat': 'Late',\r\n        'Pengganti': 'Substitute',\r\n      };\r\n      alert(`Successfully checked in as ${statusLabels[selectedStatus]}!`);\r\n    } catch (err) {\r\n      alert(`Check-in failed: ${err instanceof Error ? err.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"fixed inset-0 bg-black/50 z-40\" onClick={onClose} />\r\n      {/* Modal */}\r\n      <div className=\"fixed inset-0 flex items-center justify-center z-50 p-4\">\r\n        <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-200 sticky top-0 bg-white\">\r\n            <h3 className=\"text-base lg:text-lg font-semibold text-gray-900\">\r\n              {editMode ? 'Edit Proof/Description' : 'Check-in Attendance'}\r\n            </h3>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors cursor-pointer\"\r\n              disabled={checkInMutation.isPending || updateMutation.isPending}\r\n            >\r\n              <X className=\"h-5 w-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"p-4 space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Course</label>\r\n              <div className=\"text-sm text-gray-900\">{courseName}</div>\r\n            </div>\r\n\r\n            {!editMode && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Attendance Status *</label>\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                {(['Hadir', 'Izin', 'Sakit', 'Alfa', 'Terlambat', 'Pengganti'] as const).map(status => {\r\n                  const getStatusIcon = () => {\r\n                    switch (status) {\r\n                      case 'Hadir':\r\n                        return <CheckCircle className=\"h-4 w-4\" />;\r\n                      case 'Izin':\r\n                        return <Clock className=\"h-4 w-4\" />;\r\n                      case 'Sakit':\r\n                        return <AlertCircle className=\"h-4 w-4\" />;\r\n                      case 'Terlambat':\r\n                        return <ClockAlert className=\"h-4 w-4\" />;\r\n                      case 'Pengganti':\r\n                        return <CheckCircle className=\"h-4 w-4\" />;\r\n                      case 'Alfa':\r\n                        return <XCircle className=\"h-4 w-4\" />;\r\n                    }\r\n                  };\r\n\r\n                  return (\r\n                    <button\r\n                      key={status}\r\n                      onClick={() => setSelectedStatus(status)}\r\n                      disabled={checkInMutation.isPending}\r\n                      className={`px-3 lg:px-4 py-2 text-xs lg:text-sm font-medium rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-1.5 ${\r\n                        selectedStatus === status\r\n                          ? status === 'Hadir'\r\n                            ? 'bg-green-600 text-white'\r\n                            : status === 'Alfa'\r\n                            ? 'bg-red-600 text-white'\r\n                            : status === 'Pengganti'\r\n                            ? 'bg-purple-600 text-white'\r\n                            : status === 'Terlambat'\r\n                            ? 'bg-orange-600 text-white'\r\n                            : status === 'Izin'\r\n                            ? 'bg-blue-600 text-white'\r\n                            : 'bg-yellow-600 text-white'\r\n                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                      } ${checkInMutation.isPending ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                    >\r\n                      {getStatusIcon()}\r\n                      <span className=\"hidden sm:inline\">\r\n                        {status === 'Hadir' && 'Present'}\r\n                        {status === 'Izin' && 'Permission'}\r\n                        {status === 'Sakit' && 'Sick'}\r\n                        {status === 'Alfa' && 'Absent'}\r\n                        {status === 'Terlambat' && 'Late'}\r\n                        {status === 'Pengganti' && 'Substitute'}\r\n                      </span>\r\n                      <span className=\"sm:inline md:hidden\">\r\n                        {status}\r\n                      </span>\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            )}\r\n\r\n            <div>\r\n              <label htmlFor=\"link-bukti\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Proof Link (Optional)\r\n              </label>\r\n              <input\r\n                id=\"link-bukti\"\r\n                type=\"url\"\r\n                value={linkBukti}\r\n                onChange={(e) => setLinkBukti(e.target.value)}\r\n                disabled={checkInMutation.isPending}\r\n                placeholder=\"https://example.com/proof.jpg\"\r\n                className=\"input-field w-full text-sm\"\r\n                maxLength={500}\r\n              />\r\n              <div className=\"text-xs text-gray-500 mt-1\">\r\n                Link to attendance proof (e.g., photo, document)\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Description (Optional)\r\n              </label>\r\n              <textarea\r\n                id=\"description\"\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                disabled={checkInMutation.isPending}\r\n                placeholder=\"Add a note about your attendance...\"\r\n                rows={3}\r\n                className=\"input-field w-full text-sm resize-none\"\r\n                maxLength={500}\r\n              />\r\n              <div className=\"text-xs text-gray-500 mt-1\">\r\n                {description.length}/500 characters\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-2 sm:gap-3 p-4 border-t border-gray-200 sticky bottom-0 bg-white\">\r\n            <button\r\n              onClick={onClose}\r\n              disabled={checkInMutation.isPending || updateMutation.isPending}\r\n              className=\"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer order-2 sm:order-1\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={handleCheckIn}\r\n              disabled={checkInMutation.isPending || updateMutation.isPending}\r\n              className=\"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer flex items-center justify-center gap-2 order-1 sm:order-2\"\r\n            >\r\n              {(checkInMutation.isPending || updateMutation.isPending) ? (\r\n                <>\r\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                  <span>{editMode ? 'Saving...' : 'Checking in...'}</span>\r\n                </>\r\n              ) : (\r\n                <span>{editMode ? 'Save Changes' : 'Confirm Check-in'}</span>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CheckInModal;\r\n"],"names":["CheckInModal","isOpen","meetingId","courseName","onClose","editMode","existingProof","existingDescription","selectedStatus","setSelectedStatus","React","description","setDescription","linkBukti","setLinkBukti","checkInMutation","useCheckInAttendance","updateMutation","useUpdateCheckInAttendance","handleCheckIn","err","jsxs","Fragment","jsx","X","status","getStatusIcon","CheckCircle","Clock","AlertCircle","ClockAlert","XCircle","e","Loader2"],"mappings":"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"}